<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta http-equiv="X-UA-Compatible" content="ie=edge" />
    <title>Automated SOC with SOAR Implementation</title>
    <meta name="description" content="Case study page of Automated SOC with SOAR Implementation Project" />
    <link rel="stylesheet" href="css/style.css" />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link href="https://fonts.googleapis.com/css2?family=Source+Sans+Pro:wght@400;600;700;900&display=swap" rel="stylesheet" />
    <style>
      .constrained-image {
        display: block;
        width: 100%;
        height: auto;
        cursor: pointer; /* Add a pointer cursor on hover */
        transition: transform 0.2s ease;
      }

      .constrained-image.larger {
        max-width: 1890px;
        max-height: 1100px;
      }

      .constrained-image:hover {
        transform: scale(1.03);
      }

      .project-details__img-cont {
        margin-bottom: 2rem;
        text-align: center;
      }

      /* The Modal (background) */
      .modal {
        display: none; /* Hidden by default */
        position: fixed; /* Stay in place */
        z-index: 1000; /* Sit on top */
        left: 0;
        top: 0;
        width: 100%; /* Full width */
        height: 100%; /* Full height */
        overflow: auto; /* Enable scroll if needed */
        background-color: rgba(0, 0, 0, 0.9); /* Black with opacity */
        display: flex;
        justify-content: center;
        align-items: center;
      }

      /* Modal Content (image) */
      .modal-content {
        /* margin: auto; */
        display: block;
        /* width: 80%; */
        max-width: 90%;
        max-height: 90%;
      }

      /* Close Button */
      .close {
        position: absolute;
        top: 15px;
        right: 35px;
        color: #f1f1f1;
        font-size: 40px;
        font-weight: bold;
        transition: color 0.3s;
        cursor: pointer;
      }

      .close:hover,
      .close:focus {
        color: #bbb;
        text-decoration: none;
      }
      code {
        background-color: #eee; /* Light background for code */
        padding: 2px 4px;
        border-radius: 3px;
        font-family: 'Source Code Pro', monospace; /* Monospaced font for code */
        font-size: 0.9em; /* Slightly smaller than surrounding text */
      }
    </style>
  </head>
  <body>
    <header class="header">
      <div class="header__content">
        <div class="header__logo-container">
          <a href="./index.html">
            <div class="header__logo-img-cont">
              <img src="./assets/png/john-doe.png" alt="Ram Maheshwari Logo Image" class="header__logo-img" />
            </div>
            <span class="header__logo-sub">HAN YETI</span>
          </a>
        </div>
        <div class="header__main">
          <ul class="header__links">
            <li class="header__link-wrapper">
              <a href="./index.html" class="header__link"> Home </a>
            </li>
            <li class="header__link-wrapper">
              <a href="./index.html#about" class="header__link">About </a>
            </li>
            <li class="header__link-wrapper">
              <a href="./index.html#projects" class="header__link">
                Projects
              </a>
            </li>
            <li class="header__link-wrapper">
              <a href="./index.html#contact" class="header__link"> Contact </a>
            </li>
          </ul>
          <div class="header__main-ham-menu-cont">
            <img src="./assets/svg/ham-menu.svg" alt="hamburger menu" class="header__main-ham-menu" />
            <img src="./assets/svg/ham-menu-close.svg" alt="hamburger menu close" class="header__main-ham-menu-close d-none" />
          </div>
        </div>
      </div>
      <div class="header__sm-menu">
        <div class="header__sm-menu-content">
          <ul class="header__sm-menu-links">
            <li class="header__sm-menu-link">
              <a href="./index.html"> Home </a>
            </li>
            <li class="header__sm-menu-link">
              <a href="./index.html#about"> About </a>
            </li>
            <li class="header__sm-menu-link">
              <a href="./index.html#projects"> Projects </a>
            </li>
            <li class="header__sm-menu-link">
              <a href="./index.html#contact"> Contact </a>
            </li>
          </ul>
        </div>
      </div>
    </header>
    <section class="project-cs-hero">
      <div class="project-cs-hero__content">
        <h1 class="heading-primary">Automated SOC with SOAR Implementation</h1>
        <div class="project-cs-hero__info">
          <p class="text-primary">
            In this project, I set up and deployed a fully automated Security Operations Center (SOC) within a virtual lab environment. The main challenge I tackled was the inherent inefficiency of manual incident detection and response.
          </p>
        </div>
       <!-- <div class="project-cs-hero__cta">
          <a href="#" class="btn btn--bg" target="_blank">Live Link</a>
        </div> -->
      </div>
    </section>
    <section class="project-details">
      <div class="main-container">
        <div class="project-details__content">
          <div class="project-details__showcase-img-cont">
            <img src="./assets/jpeg/project-mockup-example.jpeg" alt="Project Image" class="project-details__showcase-img" />
          </div>
          <div class="project-details__content-main">
            <div class="project-details__desc">
              <h3 class="project-details__content-title">Project Overview</h3>
              <p class="project-details__desc-para">
                In this project, I set up and deployed a fully automated Security Operations Center (SOC) within a virtual lab environment. The main challenge I tackled was the inherent inefficiency of manual incident detection and response. My solution brings together Wazuh (XDR/EDR) for thorough endpoint monitoring, TheHive (Incident Response) for organized incident management, and Shuffle (SOAR) for orchestrating automated workflows. By using Sysmon logs and creating custom rules, I built a robust system capable of simulating, detecting, and responding to advanced threats like Mimikatz in real-time. This setup shows my proactive approach. I transformed raw security events into actionable intelligence and automated critical response actions. Wazuh detected the threat, and the custom integration script successfully forwarded the alert to TheHive for immediate case management. Furthermore, automated email notifications were sent to the SOC analyst, enabling rapid case management. This automated alert creation significantly reduces response time and ensures critical incidents are promptly addressed, showcasing my ability to build resilient and efficient security operations.
              </p>
            </div>
            <div class="project-details__subsections">
              <h3 class="project-details__content-title">Key Skills Demonstrated</h3>
              <p class="project-details__desc-para">
                Wazuh, TheHive, Shuffle, Sysmon, SOAR, XDR, EDR, log analysis, alert automation, incident response, rule creation, virtualization, API integration, troubleshooting, playbook, and workflow orchestration.
              </p>
              <h3 class="project-details__content-title">Workflow</h3>
              <p class="project-details__desc-para">
                Here is the project workflow that minimizes manual intervention, ensuring that critical security incidents are detected, enriched with threat intelligence, escalated for case management, and communicated to the response team with unparalleled speed and efficiency. This project's success comes from a carefully designed automated workflow, ensuring rapid and consistent incident response. Here's a breakdown of the automated process:
              </p>

              <h3 class="project-details__content-title">Endpoint Monitoring & Log Ingestion</h3>
              <p class="project-details__desc-para">
                A Windows 10 endpoint, equipped with Sysmon, generates security events. The Wazuh agent on the endpoint collects these Sysmon operational logs and forwards them to the Wazuh Manager. Wazuh is configured to ingest and archive all raw logs into Elasticsearch for comprehensive visibility and future analysis.
              </p>

              <h3 class="project-details__content-title">Threat Detection & Custom Rule Creation</h3>
              <p class="project-details__desc-para">
                To detect specific threats like Mimikatz, I developed and put in place a custom Wazuh rule. This rule precisely identifies Mimikatz execution based on <code>originalFileName</code> within Sysmon event data, assigning a critical severity level and linking it to MITRE ATT&CK T1003 (OS Credential Dumping). Upon Mimikatz execution, Wazuh immediately generates a high-fidelity alert.
              </p>

              <h3 class="project-details__content-title">Automated Incident Creation in TheHive</h3>
              <p class="project-details__desc-para">
                I developed and deployed a custom Python integration script on the Wazuh Manager. This script is configured in <code>ossec.conf</code> to automatically forward critical Wazuh alerts, including our Mimikatz detection, directly to TheHive. TheHive receives these alerts and automatically creates new cases for incident management, filling them with all relevant details from the Wazuh alert.
              </p>

              <h3 class="project-details__content-title">SOAR Orchestration & Threat Intelligence Enrichment (Shuffle)</h3>
              <p class="project-details__desc-para">
                Wazuh alerts are also forwarded to Shuffle via a dedicated webhook. Shuffle's workflow automatically extracts the SHA256 hash from the Mimikatz alert data using a regex capture group. This extracted hash is then used to query VirusTotal via its API, enriching the alert with real-time threat intelligence and confirming the malicious nature of the executable.
              </p>

              <h3 class="project-details__content-title">Automated Analyst Notification</h3>
              <p class="project-details__desc-para">
                As the final step in the Shuffle workflow, an automated email notification is sent to the analyst. This email, filled with critical alert details (e.g., alert title, filename, affected host), ensures immediate awareness and prompts the analyst to initiate their investigation in TheHive.
              </p>

              <p class="project-details__desc-para">
                Let's get started!
              </p>

              <h3 class="project-details__content-title">Lab Network Setup Diagram</h3>
              <div class="project-details__img-cont">
                <img
                  src="./assets/Automated SOC with SOAR Implementation/0diagram.png"
                  alt="Lab Network Setup Diagram"
                  class="constrained-image"
                  id="image-1"
                  onclick="showOriginal(this)"
                />
              </div>
              <p class="project-details__desc-para">
                This diagram illustrates the lab's network setup: A Windows 10 endpoint generates security events, which are monitored by Wazuh (XDR/EDR). TheHive (incident management) and Shuffle (SOAR) are integrated to manage and automate responses, with the Analyst PC used for monitoring and analysis.
              </p>

              <h3 class="project-details__content-title">Installing Wazuh</h3>
              <p class="project-details__desc-para">
                Let's begin by installing Wazuh, the XDR/EDR platform, to establish core security monitoring and detection capabilities. The installation was performed using the official Wazuh script: <code>curl -sO https://packages.wazuh.com/4.12/wazuh-install.sh && sudo bash ./wazuh-install.sh -a</code>
              </p>
              <div class="project-details__img-cont">
                <img
                  src="./assets/Automated SOC with SOAR Implementation/1installing-wazuh.png"
                  alt="Installing Wazuh"
                  class="constrained-image"
                  id="image-2"
                  onclick="showOriginal(this)"
                />
              </div>

              <p class="project-details__desc-para">
                To access the Wazuh dashboard, I first confirmed the IP address of the Wazuh service. The <code>ifconfig</code> output revealed <code>192.168.10.11</code> as the assigned IP, which was then used for web interface access.
              </p>
              <div class="project-details__img-cont">
                <img
                  src="./assets/Automated SOC with SOAR Implementation/2ip.png"
                  alt="Wazuh IP Address"
                  class="constrained-image"
                  id="image-3"
                  onclick="showOriginal(this)"
                />
              </div>
              <div class="project-details__img-cont">
                <img
                  src="./assets/Automated SOC with SOAR Implementation/3wazuh.png"
                  alt="Wazuh Dashboard"
                  class="constrained-image"
                  id="image-4"
                  onclick="showOriginal(this)"
                />
              </div>

              <p class="project-details__desc-para">
                With Wazuh installed, the next step is to deploy an agent to the Windows 10 endpoint. As seen here, the dashboard currently shows no registered agents, prompting the "Deploy new agent" action to begin monitoring the endpoint.
              </p>
              <div class="project-details__img-cont">
                <img
                  src="./assets/Automated SOC with SOAR Implementation/4deploy-wazuh-agent.png"
                  alt="Deploy Wazuh Agent"
                  class="constrained-image"
                  id="image-5"
                  onclick="showOriginal(this)"
                />
              </div>

              <h3 class="project-details__content-title">Configuring Agent Deployment</h3>
              <p class="project-details__desc-para">
                To deploy the Wazuh agent to the Windows 10 endpoint, the server address <code>192.168.10.11</code> was assigned. An agent name, <code>myLab</code>, was also provided during this configuration step to uniquely identify the endpoint within Wazuh.
              </p>
              <div class="project-details__img-cont">
                <img
                  src="./assets/Automated SOC with SOAR Implementation/5deploy-agent.png"
                  alt="Configuring Agent Deployment"
                  class="constrained-image"
                  id="image-6"
                  onclick="showOriginal(this)"
                />
              </div>

              <p class="project-details__desc-para">
                The Wazuh dashboard provides the specific PowerShell commands to download and install the agent on the Windows 10 endpoint. This includes the Invoke-WebRequest command to retrieve the installer and msiexec.exe for silent installation, ensuring the agent connects to the Wazuh Manager at <code>192.168.10.11</code> and is named <code>myLab</code>. Following this, NET START WazuhSvc starts the agent service.
              </p>
              <div class="project-details__img-cont">
                <img
                  src="./assets/Automated SOC with SOAR Implementation/6-deploying-command.png"
                  alt="Deploying Agent Command"
                  class="constrained-image"
                  id="image-7"
                  onclick="showOriginal(this)"
                />
              </div>

              <p class="project-details__desc-para">
                After running the deployment commands on the Windows 10 endpoint, the Wazuh agent successfully registered. The dashboard now displays "myLab" (<code>192.168.10.10</code>) as an active agent, confirming it is now sending security data for monitoring.
              </p>
              <div class="project-details__img-cont">
                <img
                  src="./assets/Automated SOC with SOAR Implementation/7-node.png"
                  alt="Agent Node Registered"
                  class="constrained-image"
                  id="image-8"
                  onclick="showOriginal(this)"
                />
              </div>

              <h3 class="project-details__content-title">Installing TheHive</h3>
              <p class="project-details__desc-para">
                Next, we proceed with installing TheHive, the incident response platform. We are going to follow the official guide of TheHive : https://docs.strangebee.com/thehive/installation/step-by-step-installation-guide/ This begins by ensuring all necessary Java dependencies are in place.
              </p>
              <div class="project-details__img-cont">
                <img
                  src="./assets/Automated SOC with SOAR Implementation/8-java.png"
                  alt="Installing TheHive Dependencies (Java)"
                  class="constrained-image"
                  id="image-9"
                  onclick="showOriginal(this)"
                />
              </div>
              <p class="project-details__desc-para">
                TheHive relies on Apache Cassandra for its distributed database.
              </p>
              <div class="project-details__img-cont">
                <img
                  src="./assets/Automated SOC with SOAR Implementation/9-cassandra-status.png"
                  alt="Cassandra Status"
                  class="constrained-image"
                  id="image-10"
                  onclick="showOriginal(this)"
                />
              </div>
              <p class="project-details__desc-para">
                Elasticsearch is another dependency for TheHive, providing powerful search and analytics capabilities for incident data.
              </p>
              <div class="project-details__img-cont">
                <img
                  src="./assets/Automated SOC with SOAR Implementation/10-elasticsearch-status.png"
                  alt="Elasticsearch Status"
                  class="constrained-image"
                  id="image-11"
                  onclick="showOriginal(this)"
                />
              </div>
              <p class="project-details__desc-para">
                Now we are good to go for installing TheHive.After installing TheHive, it's crucial to correctly set file permissions to ensure proper operation and security. As shown in the ls -la /opt/thp output, the directory initially shows root as the owner. The official documentation mandates changing these permissions to thehive:thehive.
              </p>
              <div class="project-details__img-cont">
                <img
                  src="./assets/Automated SOC with SOAR Implementation/11-root-owner.png"
                  alt="Root Owner"
                  class="constrained-image"
                  id="image-12"
                  onclick="showOriginal(this)"
                />
              </div>
              <p class="project-details__desc-para">
                To align with TheHive's operational requirements, the file ownership for /opt/thp was changed recursively to thehive:thehive using the chown -R thehive:thehive /opt/thp command.
              </p>
              <div class="project-details__img-cont">
                <img
                  src="./assets/Automated SOC with SOAR Implementation/12-change-ownership.png"
                  alt="Change Ownership 1"
                  class="constrained-image"
                  id="image-13"
                  onclick="showOriginal(this)"
                />
              </div>
              <div class="project-details__img-cont">
                <img
                  src="./assets/Automated SOC with SOAR Implementation/13-change-ownershipU.png"
                  alt="Change Ownership 2"
                  class="constrained-image"
                  id="image-14"
                  onclick="showOriginal(this)"
                />
              </div>
              <p class="project-details__desc-para">
                With the installation, permission adjustments and configurations complete, TheHive's web interface is now accessible, confirming the successful deployment and readiness for incident management operations.
              </p>
              <div class="project-details__img-cont">
                <img
                  src="./assets/Automated SOC with SOAR Implementation/14-thehive.png"
                  alt="TheHive Interface"
                  class="constrained-image"
                  id="image-15"
                  onclick="showOriginal(this)"
                />
              </div>
              <p class="project-details__desc-para">
                Default cretendials for the hive are : admin@thehive.local - secret When i try to login with this credentials there's an error occuring so now we have to solve this.
              </p>
              <div class="project-details__img-cont">
                <img
                  src="./assets/Automated SOC with SOAR Implementation/15-errorHive.png"
                  alt="TheHive Login Error"
                  class="constrained-image"
                  id="image-16"
                  onclick="showOriginal(this)"
                />
              </div>
              <p class="project-details__desc-para">
                When i check the Elasticsearch service, i see that it failed to start due to it being killed by the Out Of Memory (OOM) Killer, indicating insufficient available memory to run the service.
              </p>
              <div class="project-details__img-cont">
                <img
                  src="./assets/Automated SOC with SOAR Implementation/16-esError.png"
                  alt="Elasticsearch OOM Error"
                  class="constrained-image"
                  id="image-17"
                  onclick="showOriginal(this)"
                />
              </div>
              <p class="project-details__desc-para">
                The OOM Killer is a mechanism in the Linux kernel that steps in when the system is critically low on memory. It selects and terminates processes to free up memory and prevent the entire system from crashing or becoming unresponsive. Elasticsearch, especially with default configurations or when handling significant data, can be memory-intensive. How to solve this problem: 1. Increase Available Memory: The most direct solution is to provide more RAM to the machine running Elasticsearch. If possible, upgrade the system's memory. 2. Reduce Elasticsearch Memory Usage: If you can't increase the RAM, you need to configure Elasticsearch to use less memory. This involves adjusting the JVM heap size that Elasticsearch uses. My solution : I don't want to reduce the performance of Elasticsearch so i'm gonna increase the RAM of my VM. With the increased RAM, the Elasticsearch service now runs without OOM issues, allowing TheHive to start and authenticate correctly.
              </p>
              <div class="project-details__img-cont">
                <img
                  src="./assets/Automated SOC with SOAR Implementation/17-theHiveLoggedin.png"
                  alt="TheHive Logged In"
                  class="constrained-image"
                  id="image-18"
                  onclick="showOriginal(this)"
                />
              </div>

              <h3 class="project-details__content-title">Sysmon Integration</h3>
              <p class="project-details__desc-para">
                To ingest Sysmon logs into Wazuh for comprehensive endpoint monitoring, the full name of the Sysmon operational log (Microsoft-Windows-Sysmon/Operational) is identified within the Event Viewer.
              </p>
              <div class="project-details__img-cont">
                <img
                  src="./assets/Automated SOC with SOAR Implementation/18-sysmonPath.png"
                  alt="Sysmon Path"
                  class="constrained-image"
                  id="image-19"
                  onclick="showOriginal(this)"
                />
              </div>
              <p class="project-details__desc-para">
                To integrate Sysmon logs with Wazuh, I modified the ossec.conf file on the Windows 10 agent. Specifically, I added a &lt;localfile&gt; entry, pointing to the Microsoft-Windows-Sysmon/Operational event channel, ensuring these security events are now collected and forwarded to the Wazuh Manager for analysis.
              </p>
              <div class="project-details__img-cont">
                <img
                  src="./assets/Automated SOC with SOAR Implementation/19-ossecConf.png"
                  alt="Ossec Conf"
                  class="constrained-image"
                  id="image-20"
                  onclick="showOriginal(this)"
                />
              </div>
              <p class="project-details__desc-para">
                After modifying the ossec.conf file, I restarted the Wazuh agent service on the Windows 10 endpoint. This ensures the configuration changes take effect immediately, allowing the agent to begin collecting Sysmon logs as configured.
              </p>
              <div class="project-details__img-cont">
                <img
                  src="./assets/Automated SOC with SOAR Implementation/20-restartWazuh.png"
                  alt="Restart Wazuh"
                  class="constrained-image"
                  id="image-21"
                  onclick="showOriginal(this)"
                />
              </div>
              <p class="project-details__desc-para">
                With the Wazuh agent restarted and properly configured, I verified that Sysmon logs are now being successfully ingested and displayed within the Wazuh dashboard. The search filter for "sysmon" confirms that relevant events from the Windows 10 endpoint are actively flowing into the system for monitoring and analysis.
              </p>
              <div class="project-details__img-cont">
                <img
                  src="./assets/Automated SOC with SOAR Implementation/21-sysmon-wazuh.png"
                  alt="Sysmon Wazuh"
                  class="constrained-image"
                  id="image-22"
                  onclick="showOriginal(this)"
                />
              </div>

              <h3 class="project-details__content-title">Custom Rule Creation for Mimikatz Detection</h3>
              <p class="project-details__desc-para">
                To simulate a real-world threat and test our monitoring capabilities, I executed Mimikatz—a tool commonly used for credential access—on the Windows 10 endpoint. This action is for generating specific security events that Wazuh is configured to detect and log.
              </p>
              <div class="project-details__img-cont">
                <img
                  src="./assets/Automated SOC with SOAR Implementation/22-run-mimikatz.png"
                  alt="Run Mimikatz"
                  class="constrained-image"
                  id="image-23"
                  onclick="showOriginal(this)"
                />
              </div>
              <p class="project-details__desc-para">
                After executing Mimikatz, the Wazuh dashboard initially showed "No Results" for "mimikatz" alerts. This confirmed that while Sysmon logs were being collected, Wazuh's default ruleset did not yet contain specific detections for this type of threat, demonstrating the need for custom rule creation to enhance detection capabilities.
              </p>
              <div class="project-details__img-cont">
                <img
                  src="./assets/Automated SOC with SOAR Implementation/23-no-result.png"
                  alt="No Result"
                  class="constrained-image"
                  id="image-24"
                  onclick="showOriginal(this)"
                />
              </div>
              <p class="project-details__desc-para">
                It's time to configure wazuh. But before modifying Wazuh's core configuration, I want to creat a backup of the existing ossec.conf file to ensure the ability to restore the original configuration if needed, minimizing disruption during rule development and testing.
              </p>
              <div class="project-details__img-cont">
                <img
                  src="./assets/Automated SOC with SOAR Implementation/24-copy-conf.png"
                  alt="Copy Conf"
                  class="constrained-image"
                  id="image-25"
                  onclick="showOriginal(this)"
                />
              </div>
              <p class="project-details__desc-para">
                To ensure all raw logs, including those that do not immediately trigger an alert, are stored for later analysis, I modified the ossec.conf file. Specifically, I changed the logall and logall_json parameters from "no" to "yes" within the global configuration. This enables full fidelity logging, which is essential for detailed investigations and custom rule development.
              </p>
              <div class="project-details__img-cont">
                <img
                  src="./assets/Automated SOC with SOAR Implementation/25-configured-file.png"
                  alt="Configured File"
                  class="constrained-image"
                  id="image-26"
                  onclick="showOriginal(this)"
                />
              </div>
              <p class="project-details__desc-para">
                To complement the full log collection enabled in Wazuh, I modified the filebeat.yml configuration. Specifically, I set archives: enabled to true under the filebeat.modules.wazuh.alerts section. This ensures that raw, non-alerting logs, which are critical for in-depth analysis and custom rule creation, are also ingested into Elasticsearch for comprehensive visibility.
              </p>
              <div class="project-details__img-cont">
                <img
                  src="./assets/Automated SOC with SOAR Implementation/26-filebeat-conf.png"
                  alt="Filebeat Conf"
                  class="constrained-image"
                  id="image-27"
                  onclick="showOriginal(this)"
                />
              </div>
              <p class="project-details__desc-para">
                To prepare for analyzing the newly enabled full logs, I navigated to "Dashboards Management" within the Wazuh interface, then selected "Index patterns" to create a new index pattern. This is the next step to ensure that the raw log data, including archival logs, is properly indexed and searchable for analysis.
              </p>
              <div class="project-details__img-cont">
                <img
                  src="./assets/Automated SOC with SOAR Implementation/27-index1.png"
                  alt="Index 1"
                  class="constrained-image"
                  id="image-28"
                  onclick="showOriginal(this)"
                />
              </div>
              <div class="project-details__img-cont">
                <img
                  src="./assets/Automated SOC with SOAR Implementation/27-index2.png"
                  alt="Index 2"
                  class="constrained-image"
                  id="image-29"
                  onclick="showOriginal(this)"
                />
              </div>
              <div class="project-details__img-cont">
                <img
                  src="./assets/Automated SOC with SOAR Implementation/27-index3.png"
                  alt="Index 3"
                  class="constrained-image"
                  id="image-30"
                  onclick="showOriginal(this)"
                />
              </div>
              <p class="project-details__desc-para">
                But this one gave me an error.
              </p>
              <div class="project-details__img-cont">
                <img
                  src="./assets/Automated SOC with SOAR Implementation/28-index4Error.png"
                  alt="Index 4 Error"
                  class="constrained-image"
                  id="image-31"
                  onclick="showOriginal(this)"
                />
              </div>
              <p class="project-details__desc-para">
                I tried to create new index pattern with a single * then it worked.
              </p>
              <div class="project-details__img-cont">
                <img
                  src="./assets/Automated SOC with SOAR Implementation/29-indexPattern.png"
                  alt="Error 1"
                  class="constrained-image"
                  id="image-32"
                  onclick="showOriginal(this)"
                />
              </div>
<p class="project-details__desc-para">
                To confirm that Sysmon successfully captured the Mimikatz execution and Wazuh archived the raw event, I used cat archives.json piped through grep -i mimikatz. The output clearly shows the detailed Sysmon event logs related to the Mimikatz process, confirming that our comprehensive logging setup is effectively collecting even non-alerting security events. This data is now available for further analysis and custom rule creation.
              </p>
              <div class="project-details__img-cont">
                <img
                  src="./assets/Automated SOC with SOAR Implementation/30-check-logs.png"
                  alt="Check Logs"
                  class="constrained-image"
                  id="image-33"
                  onclick="showOriginal(this)"
                />
              </div>

              <p class="project-details__desc-para">
                After enabling full log collection and verifying the raw archives.json file, I searched the Wazuh dashboard's "wazuh-archives-*" index for "mimikatz" events. The successful query, showing "11 hits" and displaying the detailed Sysmon logs related to Mimikatz execution, confirms that the raw, non-alerting events are now fully searchable and accessible within the Wazuh interface.
              </p>
              <div class="project-details__img-cont">
                <img
                  src="./assets/Automated SOC with SOAR Implementation/31-wazuh-dashboard-hit.png"
                  alt="Wazuh Dashboard Hit"
                  class="constrained-image"
                  id="image-34"
                  onclick="showOriginal(this)"
                />
              </div>

              <p class="project-details__desc-para">
                To create a custom rule for Mimikatz detection, I navigated to "Server Management" -> "Rules" -> "Manage Rule Files" in the Wazuh dashboard. Here, I identified 0800-sysmon_id_1.xml as the appropriate file within the ruleset/rules directory. This is where we'll add our specific detection logic for the Mimikatz activity.
              </p>
              <div class="project-details__img-cont">
                <img
                  src="./assets/Automated SOC with SOAR Implementation/32-manage-rule.png"
                  alt="Manage Rule"
                  class="constrained-image"
                  id="image-35"
                  onclick="showOriginal(this)"
                />
              </div>
              <p class="project-details__desc-para">
                Copy one of them to build your custom rule.
              </p>
              <div class="project-details__img-cont">
                <img
                  src="./assets/Automated SOC with SOAR Implementation/33-copy-sample.png"
                  alt="Copy Sample"
                  class="constrained-image"
                  id="image-36"
                  onclick="showOriginal(this)"
                />
              </div>
              <p class="project-details__desc-para">
                Create custom rule -> local_rules -> paste here
              </p>
              <div class="project-details__img-cont">
                <img
                  src="./assets/Automated SOC with SOAR Implementation/34-paste-sample.png"
                  alt="Paste Sample"
                  class="constrained-image"
                  id="image-37"
                  onclick="showOriginal(this)"
                />
              </div>
              <p class="project-details__desc-para">
                Before defining the custom detection rule, I analyzed the archived Mimikatz logs in the Wazuh dashboard. Specifically, I extracted the data.win.eventdata.originalFileName field, which contains "mimikatz.exe". This unique and reliable indicator will be used as a key element in our custom rule to accurately detect future Mimikatz executions.
              </p>
              <div class="project-details__img-cont">
                <img
                  src="./assets/Automated SOC with SOAR Implementation/35-original-name.png"
                  alt="Original Name"
                  class="constrained-image"
                  id="image-38"
                  onclick="showOriginal(this)"
                />
              </div>
              <p class="project-details__desc-para">
                With the relevant log data identified, I crafted a custom rule within local_rules.xml to detect Mimikatz execution. This rule is designed with the highest critical level="15" and specifically targets originalFileName for "mimikatz.exe" (case-insensitive). I also linked it to MITRE ATT&CK T1003 (OS Credential Dumping), providing immediate threat context.
              </p>
              <div class="project-details__img-cont">
                <img
                  src="./assets/Automated SOC with SOAR Implementation/36-local-rule.png"
                  alt="Custom Rule"
                  class="constrained-image"
                  id="image-39"
                  onclick="showOriginal(this)"
                />
              </div>
              <p class="project-details__desc-para">
                Now it's time to test. Here's Wazuh dashboard before i'm re-executing mimikatz.exe
              </p>
              <div class="project-details__img-cont">
                <img
                  src="./assets/Automated SOC with SOAR Implementation/37-beforeRe.png"
                  alt="Before Re-execution"
                  class="constrained-image"
                  id="image-40"
                  onclick="showOriginal(this)"
                />
              </div>

              <p class="project-details__desc-para">
                Executing mimikatz.exe
              </p>
              <div class="project-details__img-cont">
                <img
                  src="./assets/Automated SOC with SOAR Implementation/38-exeMimikatz.png"
                  alt="Executing Mimikatz"
                  class="constrained-image"
                  id="image-41"
                  onclick="showOriginal(this)"
                />
              </div>

              <p class="project-details__desc-para">
                After restarting the Wazuh manager and re-executing Mimikatz on the Windows 10 endpoint, our custom detection rule immediately triggered a high-severity alert. As highlighted, the Wazuh dashboard now displays a new event with rule.mitre.id as T1003 (Credential Access) and rule.description clearly stating "Mimikatz Usage Detected!!!".
              </p>
              <div class="project-details__img-cont">
                <img
                  src="./assets/Automated SOC with SOAR Implementation/39-afterRe.png"
                  alt="After Re-execution"
                  class="constrained-image"
                  id="image-42"
                  onclick="showOriginal(this)"
                />
              </div>
              <h3 class="project-details__content-title">Integrating SOAR</h3>
              <p class="project-details__desc-para">
                Now, to enable automated incident response, I'm integrating Shuffle, our SOAR platform, with Wazuh. This screenshot shows the initial configuration within Shuffle, where I'm setting up a new "Wazuh-alerts" webhook. The critical step here is obtaining the unique "Webhook URI" (https://shuffler.io/api/v1/hooks/webhook), which will act as the communication channel for Wazuh alerts to be sent to Shuffle for orchestration and automation. This setup lays the groundwork for Shuffle to receive and process security alerts.<br>I'm going to follow https://wazuh.com/blog/integrating-wazuh-with-shuffle/
              </p>
              <div class="project-details__img-cont">
                <img
                  src="./assets/Automated SOC with SOAR Implementation/40-shuffleURI.png"
                  alt="Shuffle URI"
                  class="constrained-image"
                  id="image-43"
                  onclick="showOriginal(this)"
                />
              </div>

              <p class="project-details__desc-para">
                To bridge Wazuh and Shuffle, I modified the ossec.conf file on the Wazuh Manager, adding an &lt;integration&gt; block. As highlighted, this configuration directs Wazuh to forward alerts to Shuffle's webhook URI, specifically including our custom Mimikatz alert (rule_id 100002). By specifying alert_format as json, we ensure the alerts are sent in a structured format, enabling seamless parsing and automation within Shuffle.
              </p>
              <div class="project-details__img-cont">
                <img
                  src="./assets/Automated SOC with SOAR Implementation/41-configure-ossec.png"
                  alt="Configure Ossec"
                  class="constrained-image"
                  id="image-44"
                  onclick="showOriginal(this)"
                />
              </div>
              <p class="project-details__desc-para">
                Following the ossec.conf modifications and restarting the Wazuh service, I initiated the Shuffle webhook. The screenshot confirms its successful activation, displaying "Webhook: running" and a notification indicating "Successfully started webhook."
              </p>
              <div class="project-details__img-cont">
                <img
                  src="./assets/Automated SOC with SOAR Implementation/42-running.png"
                  alt="Running"
                  class="constrained-image"
                  id="image-45"
                  onclick="showOriginal(this)"
                />
              </div>
              <p class="project-details__desc-para">
                Here, we can test the workflow.
              </p>
              <div class="project-details__img-cont">
                <img
                  src="./assets/Automated SOC with SOAR Implementation/43-testWF.png"
                  alt="Test WF"
                  class="constrained-image"
                  id="image-46"
                  onclick="showOriginal(this)"
                />
              </div>
              <p class="project-details__desc-para">
                I re-executed Mimikatz on the Windows 10 endpoint. The screenshot confirms that the alert was successfully ingested by Shuffle, showing a "FINISHED" status for the webhook event. Critically, the JSON payload reveals our custom rule_id: "100002", a "Mimikatz Usage Detected!!!" title, and associated details like severity: 3. This validates the seamless flow of high-fidelity alerts from Wazuh to Shuffle, confirming our SOAR platform is ready to automate responses based on critical security events.
              </p>
              <div class="project-details__img-cont">
                <img
                  src="./assets/Automated SOC with SOAR Implementation/44-confirm.png"
                  alt="Confirm"
                  class="constrained-image"
                  id="image-47"
                  onclick="showOriginal(this)"
                />
              </div>

              <h3 class="project-details__content-title">Threat Intelligence Enrichment (VirusTotal)</h3>
              <p class="project-details__desc-para">
                To enrich the alert data and facilitate threat intelligence lookups, the automated workflow needs specific details from the Mimikatz alert. This screenshot displays the raw event data, highlighting the hashes field which contains the SHA1 hash (D1F783...). Crucially, within this same log, the SHA256 hash is also present, which will be the primary identifier used for reputation checks. This extraction step is vital for context-rich incident analysis.
              </p>
              <div class="project-details__img-cont">
                <img
                  src="./assets/Automated SOC with SOAR Implementation/45-hashes1.png"
                  alt="Hashes 1"
                  class="constrained-image"
                  id="image-48"
                  onclick="showOriginal(this)"
                />
              </div>
              <div class="project-details__img-cont">
                <img
                  src="./assets/Automated SOC with SOAR Implementation/45-hashes2.png"
                  alt="Hashes 2"
                  class="constrained-image"
                  id="image-49"
                  onclick="showOriginal(this)"
                />
              </div>

              <p class="project-details__desc-para">
                To automate the VirusTotal lookup, I implemented a "Regex capture group" action within Shuffle. This step is for extracting the SHA256 hash from the incoming Wazuh alert. As shown, the Input data is set to $exec.text.win.eventdata.hashes, targeting the field containing the hash string. The Regex used, SHA256=([0-9A-Fa-f]{64}), precisely identifies and captures the 64-character SHA256 value. This ensures that only the relevant hash is extracted, preparing it for the next step in our automated workflow.
              </p>
              <div class="project-details__img-cont">
                <img
                  src="./assets/Automated SOC with SOAR Implementation/46-regexsha.png"
                  alt="Regex SHA"
                  class="constrained-image"
                  id="image-50"
                  onclick="showOriginal(this)"
                />
              </div>

              <p class="project-details__desc-para">
                Here we can confirm extraction of the SHA256 hash.
              </p>
              <div class="project-details__img-cont">
                <img
                  src="./assets/Automated SOC with SOAR Implementation/47-confirmhasg.png"
                  alt="Confirm Hash"
                  class="constrained-image"
                  id="image-51"
                  onclick="showOriginal(this)"
                />
              </div>

              <p class="project-details__desc-para">
                With the SHA256 hash successfully extracted, I performed a lookup on VirusTotal to gather reputation information about the Mimikatz executable. It's time to use my VirusTotal API key to be able to parse this information.
              </p>
              <div class="project-details__img-cont">
                <img
                  src="./assets/Automated SOC with SOAR Implementation/48-lookup.png"
                  alt="Lookup"
                  class="constrained-image"
                  id="image-52"
                  onclick="showOriginal(this)"
                />
              </div>

              <p class="project-details__desc-para">
                I set up a "Get a hash report" action within Shuffle. Here, I made sure to connect the extracted SHA256 hash to the VirusTotal query. You can see the Id field is populated with $sha256_regex.group_0, which pulls the hash directly from our previous parsing step. This ensures Shuffle automatically sends the right hash to VirusTotal for reputation analysis, weaving external threat intelligence right into our automated workflow.
              </p>
              <div class="project-details__img-cont">
                <img
                  src="./assets/Automated SOC with SOAR Implementation/49-hashreport.png"
                  alt="Hash Report"
                  class="constrained-image"
                  id="image-53"
                  onclick="showOriginal(this)"
                />
              </div>
              <p class="project-details__desc-para">
                Troubleshooting: VirusTotal API Error! After configuring the VirusTotal lookup, the workflow encountered an error. The screenshot shows a status: 404 and an error message "Resource not found." This indicates that the API endpoint or the way the hash was being sent to VirusTotal was incorrect, preventing a successful lookup.
              </p>
              <div class="project-details__img-cont">
                <img
                  src="./assets/Automated SOC with SOAR Implementation/50-error.png"
                  alt="Error"
                  class="constrained-image"
                  id="image-53"
                  onclick="showOriginal(this)"
                />
              </div>
              <p class="project-details__desc-para">
                To resolve the "Resource not found" error, I reviewed the available VirusTotal API actions within Shuffle. Here we can see the correct endpoint for retrieving a hash report: GET /files/{id}.
              </p>
              <div class="project-details__img-cont">
                <img
                  src="./assets/Automated SOC with SOAR Implementation/51-solve.png"
                  alt="Solve"
                  class="constrained-image"
                  id="image-54"
                  onclick="showOriginal(this)"
                />
              </div>
              <p class="project-details__desc-para">
                It means i just provided the wrong regex. i had to pick “list” here.
              </p>
              <div class="project-details__img-cont">
                <img
                  src="./assets/Automated SOC with SOAR Implementation/52-listPick.png"
                  alt="List Pick"
                  class="constrained-image"
                  id="image-55"
                  onclick="showOriginal(this)"
                />
              </div>
              <p class="project-details__desc-para">
                Here's the correct identifying API endpoint.
              </p>
              <div class="project-details__img-cont">
                <img
                  src="./assets/Automated SOC with SOAR Implementation/53-correct.png"
                  alt="Correct"
                  class="constrained-image"
                  id="image-56"
                  onclick="showOriginal(this)"
                />
              </div>
              <p class="project-details__desc-para">
                After correcting the API endpoint, the VirusTotal lookup within Shuffle now shows a successful result. The output clearly indicates malicious: 64 under last_analysis_stats, confirming that 64 out of the analyzed security vendors identified the file as malicious. This successful integration provides immediate, actionable threat intelligence directly within our automated workflow, verifying the malicious nature of the Mimikatz executable.
              </p>
              <div class="project-details__img-cont">
                <img
                  src="./assets/Automated SOC with SOAR Implementation/54-success1.png"
                  alt="Success 1"
                  class="constrained-image"
                  id="image-57"
                  onclick="showOriginal(this)"
                />
              </div>
              <div class="project-details__img-cont">
                <img
                  src="./assets/Automated SOC with SOAR Implementation/54-success2.png"
                  alt="Success 2"
                  class="constrained-image"
                  id="image-58"
                  onclick="showOriginal(this)"
                />
              </div>

              <h3 class="project-details__content-title">TheHive Integration</h3>

              <p class="project-details__desc-para">
                Why do we need TheHive
              </p>
              <div class="project-details__img-cont">
                <img
                  src="./assets/Automated SOC with SOAR Implementation/55-why.png"
                  alt="Why TheHive"
                  class="constrained-image"
                  id="image-59"
                  onclick="showOriginal(this)"
                />
              </div>

              <p class="project-details__desc-para">
                I am going to follow here : https://wazuh.com/blog/using-wazuh-and-thehive-for-threat-protection-and-incident-response/<br>To begin integrating TheHive directly with Wazuh, I first navigated to the /var/ossec/integrations directory on the Wazuh Manager. Listing the contents of this directory, as shown, reveals the existing integration scripts such as shuffle.py, virustotal.py, and slack.py. This step confirms the location where custom integration scripts, like the one we'll use for TheHive, are stored and executed by Wazuh.
              </p>
              <div class="project-details__img-cont">
                <img
                  src="./assets/Automated SOC with SOAR Implementation/56-file.png"
                  alt="Integrations File"
                  class="constrained-image"
                  id="image-60"
                  onclick="showOriginal(this)"
                />
              </div>

              <p class="project-details__desc-para">
                To facilitate direct integration between Wazuh and TheHive, I created a new custom script named custom-w2thive within the /var/ossec/integrations directory. This script, written in Python, will act as the bridge, processing Wazuh alerts and forwarding them to TheHive. This custom solution allows for tailored incident creation and management directly from Wazuh, bypassing the need for an intermediary SOAR platform like Shuffle for this specific integration.
              </p>
              <div class="project-details__img-cont">
                <img
                  src="./assets/Automated SOC with SOAR Implementation/57-creation.png"
                  alt="Script Creation"
                  class="constrained-image"
                  id="image-61"
                  onclick="showOriginal(this)"
                />
              </div>

              <p class="project-details__desc-para">
                Here's the file i created.
              </p>
              <div class="project-details__img-cont">
                <img
                  src="./assets/Automated SOC with SOAR Implementation/58-hereis.png"
                  alt="Custom Script Content"
                  class="constrained-image"
                  id="image-62"
                  onclick="showOriginal(this)"
                />
              </div>

              <p class="project-details__desc-para">
                It need the correct permissions, so i have to run these commands :<br><code>sudo chmod 755 /var/ossec/integrations/custom-w2thive.py</code><br><code>sudo chmod 755 /var/ossec/integrations/custom-w2thive</code><br><code>sudo chown root:wazuh /var/ossec/integrations/custom-w2thive.py</code><br><code>sudo chown root:wazuh /var/ossec/integrations/custom-w2thive</code>
              </p>

              <p class="project-details__desc-para">
                To activate the direct integration, I modified the ossec.conf file on the Wazuh Manager, adding a new &lt;integration&gt; block for custom-w2thive. Here we can see the configuration details: the hook_url is set to TheHive server's IP and port 9000, and a dedicated api_key is provided for authentication. The alert_format is specified as json to ensure structured data transfer.
              </p>
              <div class="project-details__img-cont">
                <img
                  src="./assets/Automated SOC with SOAR Implementation/59-configure.png"
                  alt="Configure Wazuh Integration"
                  class="constrained-image"
                  id="image-63"
                  onclick="showOriginal(this)"
                />
              </div>

              <p class="project-details__desc-para">
                After restarting the Wazuh service, I navigated to TheHive's alert dashboard to verify the integration. Here we can see new alerts successfully received from Wazuh.
              </p>
              <div class="project-details__img-cont">
                <img
                  src="./assets/Automated SOC with SOAR Implementation/60-alerts.png"
                  alt="TheHive Alerts"
                  class="constrained-image"
                  id="image-64"
                  onclick="showOriginal(this)"
                />
              </div>

              <p class="project-details__desc-para">
                After re-executing Mimikatz on the Windows 10 endpoint, TheHive's alert dashboard immediately displayed a new, critical alert. As highlighted, the alert is titled "Mimikatz Usage Detected!!!" and directly references our custom Wazuh rule (rule.id: 100002). This confirms the seamless end-to-end integration: Wazuh detected the threat, and the custom integration script successfully forwarded the alert to TheHive for immediate case management. This automated alert creation significantly reduces response time and ensures critical incidents are promptly addressed.
              </p>
              <div class="project-details__img-cont">
                <img
                  src="./assets/Automated SOC with SOAR Implementation/61-mima1.png"
                  alt="Mimikatz Alert in TheHive 1"
                  class="constrained-image"
                  id="image-65"
                  onclick="showOriginal(this)"
                />
              </div>
              <div class="project-details__img-cont">
                <img
                  src="./assets/Automated SOC with SOAR Implementation/61-mima2.png"
                  alt="Mimikatz Alert in TheHive 2"
                  class="constrained-image"
                  id="image-66"
                  onclick="showOriginal(this)"
                />
              </div>

              <h3 class="project-details__content-title">Automated Notification: Sending Email to Analyst</h3>
              <p class="project-details__desc-para">
                To ensure the analyst is immediately notified of critical incidents, I added a "Send email shuffle" action to our workflow. Here we can see the email configuration: the recipient is set to test@outlook.com, the subject line is "High Severity Alert!", and the body dynamically populates key alert details. This includes the alert title ($exec.title), the original filename ($exec.text.win.eventdata.originalFileName), and the affected host ($exec.text.win.system.computer). This automated email ensures timely communication and prompts the analyst to begin their investigation in TheHive.
              </p>
              <div class="project-details__img-cont">
                <img
                  src="./assets/Automated SOC with SOAR Implementation/62-email.png"
                  alt="Email"
                  class="constrained-image"
                  id="image-66"
                  onclick="showOriginal(this)"
                />
              </div>
              <p class="project-details__desc-para">
                After the full workflow execution, here we can see the successful delivery of the automated email notification to the analyst. The email, sent by the "Shuffle Email App," has the subject "High Severity Alert!" and dynamically includes critical details: "Mimikatz Usage Detected!!! File name: mimikatz.exe activity on host DESKTOP-G6HR1ED." This final step in the SOAR playbook ensures that analysts are promptly informed of high-priority incidents, enabling them to initiate investigations swiftly.
              </p>
              <div class="project-details__img-cont">
                <img
                  src="./assets/Automated SOC with SOAR Implementation/63.email.png"
                  alt="Email Confirmation"
                  class="constrained-image"
                  id="image-67"
                  onclick="showOriginal(this)"
                />
              </div>
              
     <div class="project-details__tools-used">
       <h3 class="project-details__content-title">Tools/Skills Used</h3>
       <div class="skills">
        <div class="skills__skill">Wazuh</div>
        <div class="skills__skill">TheHive</div>
        <div class="skills__skill">Shuffle</div>
        <div class="skills__skill">Sysmon</div>
        <div class="skills__skill">SOAR</div>
        <div class="skills__skill">XDR</div>
        <div class="skills__skill">EDR</div>
        <div class="skills__skill">Log Analysis</div>
        <div class="skills__skill">Alert Automation</div>
        <div class="skills__skill">Incident Response</div>
        <div class="skills__skill">Rule Creation</div>
        <div class="skills__skill">Virtualization</div>
        <div class="skills__skill">API Integration</div>
        <div class="skills__skill">Troubleshooting</div>
        <div class="skills__skill">Playbook</div>
        <div class="skills__skill">Workflow Orchestration</div>
       </div>
    </div>

      
            <!---<div class="project-details__links">
              <h3 class="project-details__content-title">See Live</h3>
              <a href="#" class="btn btn--med btn--theme project-details__links-btn" target="_blank">Live Link</a>
              <a href="#" class="btn btn--med btn--theme-inv project-details__links-btn" target="_blank">Code Link</a>
            </div>--->
          </div>
        </div>
      </div>
    </section>
    <footer class="main-footer">
      <div class="main-container">
        <div class="main-footer__upper">
          <div class="main-footer__row main-footer__row-1">
            <h2 class="heading heading-sm main-footer__heading-sm">
              <span>Social</span>
            </h2>
            <div class="main-footer__social-cont">
              <a target="_blank" rel="noreferrer" href="#">
                <img class="main-footer__icon" src="./assets/png/linkedin-ico.png" alt="icon" />
              </a>
              <a target="_blank" rel="noreferrer" href="#">
                <img class="main-footer__icon" src="./assets/png/github-ico.png" alt="icon" />
              </a>
              <!--<a target="_blank" rel="noreferrer" href="#">
                <img class="main-footer__icon" src="./assets/png/twitter-ico.png" alt="icon" />
              </a>-->
              <a target="_blank" rel="noreferrer" href="#">
                <img class="main-footer__icon" src="./assets/png/yt-ico.png" alt="icon" />
              </a>
              <!--<a target="_blank" rel="noreferrer" href="#">
                <img class="main-footer__icon main-footer__icon--mr-none" src="./assets/png/insta-ico.png" alt="icon" />
              </a>-->
            </div>
          </div>
          <div class="main-footer__row main-footer__row-2">
            <h4 class="heading heading-sm text-lt">Han Yeti</h4>
            <p class="main-footer__short-desc">
              Certified Cybersecurity Professional
            </p>
          </div>
        </div>

      </div>
    </footer>
    <div id="image-modal" class="modal">
      <span class="close" onclick="closeModal()">&times;</span>
      <img id="modal-img" class="modal-content" />
    </div>
    <script>
      const images = document.querySelectorAll('.constrained-image');
      const modal = document.getElementById("image-modal");
      const modalImg = document.getElementById("modal-img");

      modal.style.display = "none";

      images.forEach(img => {
        img.onload = () => {
          if (img.naturalWidth > 1890 || img.naturalHeight > 1100) {
            img.classList.add('larger');
          }
        };
        img.onclick = () => showOriginal(img.id);
      });

      function showOriginal(imgId) {
        const img = document.getElementById(imgId);
        modalImg.src = img.src;
        modal.style.display = "flex";
      }

      function closeModal() {
        modal.style.display = "none";
      }
    </script>
  </body>
</html>
