<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta http-equiv="X-UA-Compatible" content="ie=edge" />
    <title>Case Study of Project 1</title>
    <meta name="description" content="Case study page of Project" />
    <link rel="stylesheet" href="css/style.css" />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link href="https://fonts.googleapis.com/css2?family=Source+Sans+Pro:wght@400;600;700;900&display=swap" rel="stylesheet" />
    <style>
      .constrained-image {
        display: block;
        width: 100%;
        height: auto;
        cursor: pointer; /* Add a pointer cursor on hover */
        transition: transform 0.2s ease;
      }

      .constrained-image.larger {
        max-width: 1890px;
        max-height: 1100px;
      }

      .constrained-image:hover {
        transform: scale(1.03);
      }

      .project-details__img-cont {
        margin-bottom: 2rem;
        text-align: center;
      }

      /* The Modal (background) */
      .modal {
        display: none; /* Hidden by default */
        position: fixed; /* Stay in place */
        z-index: 1000; /* Sit on top */
        padding-top: 50px; /* Location of the box */
        left: 0;
        top: 0;
        width: 100%; /* Full width */
        height: 100%; /* Full height */
        overflow: auto; /* Enable scroll if needed */
        background-color: rgba(0,0,0,0.9); /* Black w/ opacity */
        align-items: center;
        justify-content: center;
      }

      /* Modal Content (image) */
      .modal-content {
        margin: auto;
        display: block;
        width: 80%;
        max-width: 1200px;
        max-height: 90vh; /* Limit height to viewport height */
        object-fit: contain; /* Ensure image fits within bounds */
      }

      /* The Close Button */
      .close {
        position: absolute;
        top: 15px;
        right: 35px;
        color: #f1f1f1;
        font-size: 40px;
        font-weight: bold;
        transition: 0.3s;
        cursor: pointer;
      }

      .close:hover,
      .close:focus {
        color: #bbb;
        text-decoration: none;
        cursor: pointer;
      }
    </style>
  </head>
  <body>
    <header class="header">
      <div class="header__content">
        <div class="header__logo-container">
          <div class="header__logo-img-cont">
            <img src="./assets/png/john-doe.png" alt="John Doe Logo" class="header__logo-img" />
          </div>
          <span class="header__logo-sub">John Doe</span>
        </div>
        <div class="header__main">
          <ul class="header__links">
            <li class="header__link-wrapper">
              <a href="./index.html" class="header__link"> Home </a>
            </li>
            <li class="header__link-wrapper">
              <a href="./index.html#about" class="header__link">About</a>
            </li>
            <li class="header__link-wrapper">
              <a href="./index.html#projects" class="header__link">
                Projects
              </a>
            </li>
            <li class="header__link-wrapper">
              <a href="./index.html#contact" class="header__link"> Contact </a>
            </li>
          </ul>
          <div class="header__main-ham-menu-cont">
            <img
              src="./assets/svg/ham-menu.svg"
              alt="hamburger menu"
              class="header__main-ham-menu"
            />
          </div>
        </div>
      </div>
      <div class="header__sm-menu">
        <div class="header__sm-menu-content">
          <ul class="header__sm-menu-links">
            <li class="header__sm-menu-link-wrapper">
              <a href="./index.html" class="header__sm-menu-link"> Home </a>
            </li>

            <li class="header__sm-menu-link-wrapper">
              <a href="./index.html#about" class="header__sm-menu-link">
                About
              </a>
            </li>

            <li class="header__sm-menu-link-wrapper">
              <a href="./index.html#projects" class="header__sm-menu-link">
                Projects
              </a>
            </li>

            <li class="header__sm-menu-link-wrapper">
              <a href="./index.html#contact" class="header__sm-menu-link">
                Contact
              </a>
            </li>
          </ul>
        </div>
      </div>
    </header>
    <section class="project-details">
      <div class="main-container">
        <div class="project-details__content">
          <div class="project-details__content-main">
            <div class="project-details__desc">
              <h1 class="heading heading-sec heading-sec__mb-bg">
                <span class="heading-sec__main">Active Directory Threat Simulation and SIEM Analysis</span>
              </h1>
              <p class="project-details__content-para">
                <h2>Project Overview</h2>
                <p>In this project, I built and operated a comprehensive virtual lab environment to simulate Active Directory (AD) threats and analyze their impact using a Security Information and Event Management (SIEM) system. The primary challenge was to understand how advanced attacks target organizations and to confirm that our security monitoring (SIEM) could effectively capture and detect these threats. I set up a realistic domain with a Windows Server acting as an Active Directory Domain Controller, a Windows 10 endpoint, and a Kali Linux machine for offensive operations. All network and system events were systematically collected and analyzed by Splunk, which I deployed on an Ubuntu server.</p>
                <p>Through this lab, I demonstrated my ability to not only simulate common and advanced attack vectors, such as RDP brute-force and Atomic Red Team techniques (like local account creation and data exfiltration), but also to precisely track and analyze their telemetry in Splunk. This project provided crucial insights into how a well-configured SIEM provides exceptional visibility, even when attacks are unsuccessful. I confirmed that Splunk effectively captured and indexed critical security events, providing crucial visibility into unauthorized access attempts and simulated adversary activities, which is fundamental for effective threat detection and incident response.</p>
                <p><b>Key Skills Demonstrated:</b> Active Directory (AD DS), Splunk SIEM, Universal Forwarders, Sysmon, Powershell, VirtualBox, Networking, Windows Server, Windows 10, Kali Linux, Attack Simulation (Atomic Red Team), Incident Response, Threat Detection, Data Exfiltration, Password Brute-forcing, Metasploit, Nmap, Vulnerability Scanning (Nessus).</p>

                <h2>Environment Setup</h2>
                <div class="project-details__img-cont">
                    <img id="image-1-environment_setup" src="/assets/Active Directory Threat Simulation and SIEM Analysis/1-environment_setup.png" alt="Environment Setup" class="constrained-image">
                </div>
                <h3>Active Directory Domain Controller (Windows Server 2019)</h3>
                <ul>
                    <li>Configured as the primary domain controller for the `splunk.local` domain.</li>
                    <li>Installed and configured Active Directory Domain Services (AD DS).</li>
                    <li>Created various OUs, users, and groups to simulate a realistic organizational structure.</li>
                    <li>Enabled comprehensive logging (including security event logs).</li>
                </ul>
                <h3>Windows 10 Endpoint</h3>
                <ul>
                    <li>Joined to the `splunk.local` domain.</li>
                    <li>Represented a typical user workstation.</li>
                    <li>Installed Sysmon for advanced endpoint logging.</li>
                    <li>Configured Splunk Universal Forwarder to send Sysmon and other logs to the Splunk server.</li>
                </ul>
                <h3>Kali Linux Machine</h3>
                <ul>
                    <li>Used as the attacker machine.</li>
                    <li>Equipped with various penetration testing tools (e.g., Metasploit, Nmap, Nessus, Powershell Empire).</li>
                </ul>
                <h3>Splunk SIEM (Ubuntu Server)</h3>
                <ul>
                    <li>Deployed Splunk Enterprise on an Ubuntu 22.04 LTS server.</li>
                    <li>Configured data inputs to receive logs from Windows Server (Domain Controller) and Windows 10 (Endpoint) via Universal Forwarders.</li>
                    <li>Created custom dashboards, alerts, and reports for threat detection and analysis.</li>
                    <li>Indexed a wide range of log types, including:
                        <ul>
                            <li>Windows Security Event Logs (Event IDs: 4624, 4625, 4768, 4776, etc.)</li>
                            <li>Sysmon Logs (Event IDs: 1, 3, 5, 7, 8, 10, 11, etc.)</li>
                            <li>DNS Logs</li>
                            <li>Powershell Logs</li>
                        </ul>
                    </li>
                </ul>

                <h2>Threat Simulation and Analysis Workflow</h2>
                <div class="project-details__img-cont">
                    <img id="image-2-workflow" src="/assets/Active Directory Threat Simulation and SIEM Analysis/2-workflow.png" alt="Threat Simulation and Analysis Workflow" class="constrained-image">
                </div>
                <p>The simulation process involved the following steps:</p>
                <ol>
                    <li><b>Initial Access:</b> Executed various techniques to gain initial access to the network, such as RDP brute-forcing and exploiting vulnerabilities.</li>
                    <li><b>Reconnaissance:</b> Performed internal network reconnaissance to discover hosts, services, and Active Directory information.</li>
                    <li><b>Privilege Escalation:</b> Attempted to elevate privileges on compromised systems.</li>
                    <li><b>Lateral Movement:</b> Moved across the network to access other systems and accounts.</li>
                    <li><b>Data Exfiltration:</b> Simulated the exfiltration of sensitive data from the network.</li>
                </ol>

                <h3>Detailed Attack Simulations and Splunk Analysis</h3>

                <h4>1. RDP Brute-Force Attack and Splunk Detection</h4>
                <p><b>Attack Method:</b> Used `hydra` from Kali Linux to brute-force RDP credentials against the Windows 10 endpoint.</p>
                <div class="project-details__img-cont">
                    <img id="image-3-hydra" src="/assets/Active Directory Threat Simulation and SIEM Analysis/3-hydra.png" alt="Hydra Brute-Force" class="constrained-image">
                </div>
                <p><b>Splunk Detection:</b></p>
                <ul>
                    <li>Monitored Windows Security Event Logs for Event ID 4625 (An account failed to log on) on the Windows 10 endpoint.</li>
                    <li>Created Splunk alerts to trigger when a high number of 4625 events from a single source IP were observed within a short timeframe.</li>
                </ul>
                <div class="project-details__img-cont">
                    <img id="image-4-rdp_failed_logon_splunk" src="/assets/Active Directory Threat Simulation and SIEM Analysis/4-rdp_failed_logon_splunk.png" alt="Splunk RDP Failed Logon" class="constrained-image">
                </div>
                <p><b>Analysis:</b> Splunk successfully identified and alerted on the brute-force attempts, providing details such as the source IP (Kali Linux), target user accounts, and the number of failed attempts. This demonstrated effective detection of common attack vectors.</p>

                <h4>2. Local Account Creation (Atomic Red Team) and Sysmon/Splunk Analysis</h4>
                <p><b>Attack Method:</b> Used an Atomic Red Team technique (T1136.001) to create a local user account on the Windows 10 endpoint via Powershell.</p>
                <div class="project-details__img-cont">
                    <img id="image-5-atomic_red_team_local_account" src="/assets/Active Directory Threat Simulation and SIEM Analysis/5-atomic_red_team_local_account.png" alt="Atomic Red Team Local Account Creation" class="constrained-image">
                </div>
                <p><b>Splunk Detection (via Sysmon):</b></p>
                <ul>
                    <li>Sysmon (Event ID 1: Process Creation) captured the Powershell process creating the new user.</li>
                    <li>Splunk ingested these Sysmon logs and correlated them to identify the malicious activity.</li>
                </ul>
                <div class="project-details__img-cont">
                    <img id="image-6-sysmon_local_account_splunk" src="/assets/Active Directory Threat Simulation and SIEM Analysis/6-sysmon_local_account_splunk.png" alt="Sysmon Local Account Creation Splunk" class="constrained-image">
                </div>
                <p><b>Analysis:</b> Sysmon's detailed logging allowed Splunk to detect the creation of a local user account, even if it was performed through legitimate system utilities like Powershell. This highlights the importance of granular endpoint monitoring for detecting stealthy attacks.</p>

                <h4>3. Data Exfiltration Simulation and Telemetry Analysis</h4>
                <p><b>Attack Method:</b> Simulated data exfiltration using Powershell to encode and send data to an external (controlled) domain.</p>
                <div class="project-details__img-cont">
                    <img id="image-7-data_exfiltration" src="/assets/Active Directory Threat Simulation and SIEM Analysis/7-data_exfiltration.png" alt="Data Exfiltration" class="constrained-image">
                </div>
                <p><b>Splunk Detection (via Sysmon and Powershell Logs):</b></p>
                <ul>
                    <li>Sysmon (Event ID 3: Network Connection) captured the outbound connection to the exfiltration domain.</li>
                    <li>Powershell Script Block Logging captured the encoded Powershell command used for exfiltration.</li>
                </ul>
                <div class="project-details__img-cont">
                    <img id="image-8-exfiltration_splunk_telemetry_1" src="/assets/Active Directory Threat Simulation and SIEM Analysis/8-exfiltration_splunk_telemetry_1.png" alt="Exfiltration Splunk Telemetry 1" class="constrained-image">
                </div>
                <div class="project-details__img-cont">
                    <img id="image-9-exfiltration_splunk_telemetry_2" src="/assets/Active Directory Threat Simulation and SIEM Analysis/9-exfiltration_splunk_telemetry_2.png" alt="Exfiltration Splunk Telemetry 2" class="constrained-image">
                </div>
                <p>The provided screenshots of Splunk telemetry for the data exfiltration attempt are crucial for understanding the visibility a well-configured SIEM provides. They demonstrate how even an *attempt* at exfiltration, regardless of its success, leaves a rich trail of forensic data.</p>
                <p><b>Key aspects of the telemetry shown:</b></p>
                <ul>
                    <li><b>Process Details:</b> The logs clearly show `powershell.exe` as the process initiating the suspicious activity, along with its full command line, which can include encoded commands.</li>
                    <li><b>Network Connections:</b> Crucially, these logs show the attempted outbound network connection (e.g., to `example.com`), including the destination IP address and port. This is often a primary indicator of data exfiltration.</li>
                    <li><b>Encoded Data:</b> The telemetry often contains the encoded or obfuscated data that the attacker attempted to exfiltrate. While not immediately readable, the presence of such data patterns is highly suspicious and warrants further investigation.</li>
                </ul>
                <p>These logs, particularly those from Sysmon (Event ID 3 for network connections) and Powershell Script Block Logging, are invaluable. They show that `powershell.exe` was used, indicating powershell.exe attempting to connect to example.com.</p>
                <p>They contain fields like `exfiltratedData` and `encodedData`, revealing the content that was attempted to be exfiltrated (e.g., "SecretDataToExfiltrate" in its encoded form).</p>
                <p>The ability to see this telemetry in Splunk is vital for the analyst. Even if an attack is unsuccessful due to network controls or misconfigurations, the fact that our SIEM (Splunk) and endpoint logging (Sysmon via Universal Forwarder) capture these attempts provides:</p>
                <ul>
                    <li><b>Early Warning:</b> These logs serve as critical indicators of compromise (IOCs) and an attacker's intent, allowing us to detect malicious activity before it succeeds.</li>
                    <li><b>Forensic Evidence:</b> The detailed information within these logs (source IP, command line, attempted data) is invaluable for post-incident analysis and understanding the adversary's techniques.</li>
                    <li><b>Validation of Controls:</b> It confirms that our logging infrastructure is functioning correctly and that our SIEM is effectively collecting and indexing the necessary data to identify sophisticated attacks like data exfiltration attempts.</li>
                    <li><b>Opportunity for Refinement:</b> This telemetry can be used to develop or refine detection rules, ensuring that future, similar attempts are immediately flagged and alerted upon.</li>
                </ul>
                <p>This demonstrates the power of a well-configured SIEM in providing deep visibility into endpoint activities, regardless of the attack's success, which is fundamental for effective threat detection and incident response.</p>
            </div>
          </div>
        </div>
      </div>
    </section>
    <footer class="main-footer">
      <div class="main-container">
        <div class="main-footer__upper">
          <div class="main-footer__row main-footer__row-1">
            <h4 class="heading heading-sm text-lt">John Doe</h4>
            <p class="main-footer__short-desc">
              Lorem ipsum dolor sit amet consectetur adipisicing elit facilis tempora explicabo quae quod deserunt
            </p>
          </div>
        </div>
        <div class="main-footer__lower">
          <p class="text-primary" style="font-size: 1.6rem;">
            &copy; Copyright 2021. Made by
            <a rel="noreferrer" target="_blank" href="https://rammaheshwari.com">Ram Maheshwari</a>
          </p>
        </div>
      </div>
    </footer>
    <div id="image-modal" class="modal">
      <span class="close" onclick="closeModal()">&times;</span>
      <img id="modal-img" class="modal-content" />
    </div>
    <script>
      const images = document.querySelectorAll('.constrained-image');
      const modal = document.getElementById("image-modal");
      const modalImg = document.getElementById("modal-img");

      modal.style.display = "none";

      images.forEach(img => {
        img.onload = () => {
          if (img.naturalWidth > 1890 || img.naturalHeight > 1100) {
            img.classList.add('larger');
          }
        };
        img.onclick = () => showOriginal(img.id);
      });

      function showOriginal(imgId) {
        const img = document.getElementById(imgId);
        modalImg.src = img.src;
        modal.style.display = "flex";
      }

      function closeModal() {
        modal.style.display = "none";
      }
    </script>
  </body>
</html>
