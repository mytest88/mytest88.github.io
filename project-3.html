<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta http-equiv="X-UA-Compatible" content="ie=edge" />
    <title>Automated SOC with SOAR Implementation</title>
    <meta name="description" content="Case study page of Automated SOC with SOAR Implementation Project" />
    <link rel="stylesheet" href="css/style.css" />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link href="https://fonts.googleapis.com/css2?family=Source+Sans+Pro:wght@400;600;700;900&display=swap" rel="stylesheet" />
    <style>
      .constrained-image {
        display: block;
        width: 100%;
        height: auto;
        cursor: pointer; /* Add a pointer cursor on hover */
        transition: transform 0.2s ease;
      }

      .constrained-image.larger {
        max-width: 1890px;
        max-height: 1100px;
      }

      .constrained-image:hover {
        transform: scale(1.03);
      }

      .project-details__img-cont {
        margin-bottom: 2rem;
        text-align: center;
      }

      /* The Modal (background) */
      .modal {
        display: none; /* Hidden by default */
        position: fixed; /* Stay in place */
        z-index: 1000; /* Sit on top */
        left: 0;
        top: 0;
        width: 100%; /* Full width */
        height: 100%; /* Full height */
        overflow: auto; /* Enable scroll if needed */
        background-color: rgba(0, 0, 0, 0.9); /* Black with opacity */
        display: flex;
        justify-content: center;
        align-items: center;
      }

      /* Modal Content (image) */
      .modal-content {
        /* margin: auto; */
        display: block;
        /* width: 80%; */
        max-width: 90%;
        max-height: 90%;
      }

      /* Close Button */
      .close {
        position: absolute;
        top: 15px;
        right: 35px;
        color: #f1f1f1;
        font-size: 40px;
        font-weight: bold;
        transition: color 0.3s;
        cursor: pointer;
      }

      .close:hover,
      .close:focus {
        color: #bbb;
        text-decoration: none;
      }
      code {
        background-color: #eee; /* Light background for code */
        padding: 2px 4px;
        border-radius: 3px;
        font-family: 'Source Code Pro', monospace; /* Monospaced font for code */
        font-size: 0.9em; /* Slightly smaller than surrounding text */
      }
    </style>
  </head>
  <body>
    <header class="header">
      <div class="header__content">
        <div class="header__logo-container">
          <a href="./index.html">
            <div class="header__logo-img-cont">
              <img src="./assets/png/john-doe.png" alt="Ram Maheshwari Logo Image" class="header__logo-img" />
            </div>
            <span class="header__logo-sub">John Doe</span>
          </a>
        </div>
        <div class="header__main">
          <ul class="header__links">
            <li class="header__link-wrapper">
              <a href="./index.html" class="header__link"> Home </a>
            </li>
            <li class="header__link-wrapper">
              <a href="./index.html#about" class="header__link">About </a>
            </li>
            <li class="header__link-wrapper">
              <a href="./index.html#projects" class="header__link">
                Projects
              </a>
            </li>
            <li class="header__link-wrapper">
              <a href="./index.html#contact" class="header__link"> Contact </a>
            </li>
          </ul>
          <div class="header__main-ham-menu-cont">
            <img src="./assets/svg/ham-menu.svg" alt="hamburger menu" class="header__main-ham-menu" />
            <img src="./assets/svg/ham-menu-close.svg" alt="hamburger menu close d-none" class="header__main-ham-menu-close d-none" />
          </div>
        </div>
      </div>
      <div class="header__sm-menu">
        <div class="header__sm-menu-content">
          <ul class="header__sm-menu-links">
            <li class="header__sm-menu-link">
              <a href="./index.html"> Home </a>
            </li>
            <li class="header__sm-menu-link">
              <a href="./index.html#about"> About </a>
            </li>
            <li class="header__sm-menu-link">
              <a href="./index.html#projects"> Projects </a>
            </li>
            <li class="header__sm-menu-link">
              <a href="./index.html#contact"> Contact </a>
            </li>
          </ul>
        </div>
      </div>
    </header>
    <section class="project-cs-hero">
      <div class="project-cs-hero__content">
        <h1 class="heading-primary">Automated SOC with SOAR Implementation</h1>
        <div class="project-cs-hero__info">
          <p class="text-primary">
            This project involved the setup and deployment of a fully automated Security Operations Center (SOC) within a virtual lab environment.
          </p>
        </div>
        <div class="project-cs-hero__cta">
          <a href="#" class="btn btn--bg" target="_blank">Live Link</a>
        </div>
      </div>
    </section>
    <section class="project-details">
      <div class="main-container">
        <div class="project-details__content">
          <div class="project-details__showcase-img-cont">
            <img src="./assets/jpeg/project-mockup-example.jpeg" alt="Project Image" class="project-details__showcase-img" />
          </div>
          <div class="project-details__content-main">
            <div class="project-details__desc">
              <h3 class="project-details__content-title">Project Overview</h3>
              <p class="project-details__desc-para">
                This project involved the setup and deployment of a fully automated Security Operations Center (SOC) within a virtual lab environment. The primary challenge addressed was the inherent inefficiency of manual incident detection and response. The solution integrates Wazuh (XDR/EDR) for thorough endpoint monitoring, TheHive (Incident Response) for organized incident management, and Shuffle (SOAR) for orchestrating automated workflows. By utilizing Sysmon logs and crafting custom rules, a robust system was built to simulate, detect, and respond to advanced threats like Mimikatz in real-time. This setup demonstrates a proactive approach, transforming raw security events into actionable intelligence and automating critical response actions. Wazuh detected the threat, and the custom integration script successfully forwarded the alert to TheHive for immediate case management. Furthermore, automated email notifications were sent to the SOC analyst, enabling rapid case management. This automated alert creation significantly reduces response time and ensures critical incidents are promptly addressed, showcasing the ability to build resilient and efficient security operations.
              </p>
            </div>
            <div class="project-details__subsections">
              <h3 class="project-details__content-title">Key Skills Demonstrated</h3>
              <p class="project-details__desc-para">
                Wazuh, TheHive, Shuffle, Sysmon, SOAR, XDR, EDR, log analysis, alert automation, incident response, rule creation, virtualization, API integration, troubleshooting, playbook, and workflow orchestration.
              </p>
              <h3 class="project-details__content-title">Workflow</h3>
              <p class="project-details__desc-para">
                The project workflow minimizes manual intervention, ensuring that critical security incidents are detected, enriched with threat intelligence, escalated for case management, and communicated to the response team with unparalleled speed and efficiency. The success of this project stems from a carefully designed automated workflow, ensuring rapid and consistent incident response.
              </p>
              <p class="project-details__desc-para">
                Here's a breakdown of the automated process:
              </p>
              <h4>Endpoint Monitoring & Log Ingestion:</h4>
              <p class="project-details__desc-para">
                A Windows 10 endpoint, equipped with Sysmon, generates security events. The Wazuh agent on the endpoint collects these Sysmon operational logs and forwards them to the Wazuh Manager. Wazuh is configured to ingest and archive all raw logs into Elasticsearch for comprehensive visibility and future analysis.
              </p>
              <h4>Threat Detection & Custom Rule Creation:</h4>
              <p class="project-details__desc-para">
                To detect specific threats like Mimikatz, a custom Wazuh rule was developed and implemented. This rule precisely identifies Mimikatz execution based on <code>originalFileName</code> within Sysmon event data, assigning a critical severity level and linking it to MITRE ATT&CK T1003 (OS Credential Dumping). Upon Mimikatz execution, Wazuh immediately generates a high-fidelity alert.
              </p>
              <h4>Automated Incident Creation in TheHive:</h4>
              <p class="project-details__desc-para">
                A custom Python integration script was developed and deployed on the Wazuh Manager. This script is configured in <code>ossec.conf</code> to automatically forward critical Wazuh alerts, including Mimikatz detection, directly to TheHive. TheHive receives these alerts and automatically creates new cases for incident management, populating them with all relevant details from the Wazuh alert.
              </p>
              <h4>SOAR Orchestration & Threat Intelligence Enrichment (Shuffle):</h4>
              <p class="project-details__desc-para">
                Wazuh alerts are also forwarded to Shuffle via a dedicated webhook. Shuffle's workflow automatically extracts the SHA256 hash from the Mimikatz alert data using a regex capture group. This extracted hash is then used to query VirusTotal via its API, enriching the alert with real-time threat intelligence and confirming the malicious nature of the executable.
              </p>
              <h4>Automated Analyst Notification:</h4>
              <p class="project-details__desc-para">
                As the final step in the Shuffle workflow, an automated email notification is sent to the analyst. This email, containing critical alert details (e.g., alert title, filename, affected host), ensures immediate awareness and prompts the analyst to initiate their investigation in TheHive.
              </p>
              <p class="project-details__desc-para">
                Let's get started!
              </p>
              <div class="project-details__img-cont">
                <img
                  src="./assets/Automated SOC with SOAR Implementation/0diagram.png"
                  alt="Virtual Lab Environment Diagram"
                  class="constrained-image"
                  id="image-1"
                  onclick="showOriginal(this)"
                />
              </div>
              <p class="project-details__desc-para">
                This diagram illustrates the lab's network setup: A Windows 10 endpoint generates security events, which are monitored by Wazuh (XDR/EDR). TheHive (incident management) and Shuffle (SOAR) are integrated to manage and automate responses, with the Analyst PC used for monitoring and analysis.
              </p>
              <h3 class="project-details__content-title">Installing Wazuh</h3>
              <p class="project-details__desc-para">
                Installation of Wazuh, the XDR/EDR platform, was performed to establish core security monitoring and detection capabilities. The installation utilized the official Wazuh script: <code>curl -sO https://packages.wazuh.com/4.12/wazuh-install.sh && sudo bash ./wazuh-install.sh -a</code>
              </p>
              <div class="project-details__img-cont">
                <img
                  src="./assets/Automated SOC with SOAR Implementation/1installing-wazuh.png"
                  alt="Installing Wazuh Screenshot"
                  class="constrained-image"
                  id="image-2"
                  onclick="showOriginal(this)"
                />
              </div>
              <p class="project-details__desc-para">
                To access the Wazuh dashboard, the IP address of the Wazuh service was confirmed. The <code>ifconfig</code> output showed <code>192.168.10.11</code> as the assigned IP, which was then used for web interface access.
              </p>
              <div class="project-details__img-cont">
                <img
                  src="./assets/Automated SOC with SOAR Implementation/2ip.png"
                  alt="IP Address Screenshot"
                  class="constrained-image"
                  id="image-3"
                  onclick="showOriginal(this)"
                />
              </div>
              <div class="project-details__img-cont">
                <img
                  src="./assets/Automated SOC with SOAR Implementation/3wazuh.png"
                  alt="Wazuh Dashboard Screenshot"
                  class="constrained-image"
                  id="image-4"
                  onclick="showOriginal(this)"
                />
              </div>
              <p class="project-details__desc-para">
                With Wazuh installed, the next step was to deploy an agent to the Windows 10 endpoint. The dashboard initially showed no registered agents, prompting the "Deploy new agent" action to begin monitoring the endpoint.
              </p>
              <div class="project-details__img-cont">
                <img
                  src="./assets/Automated SOC with SOAR Implementation/4deploy-wazuh-agent.png"
                  alt="Deploy Wazuh Agent Screenshot"
                  class="constrained-image"
                  id="image-5"
                  onclick="showOriginal(this)"
                />
              </div>
              <h3 class="project-details__content-title">Configuring Agent Deployment</h3>
              <p class="project-details__desc-para">
                For Wazuh agent deployment to the Windows 10 endpoint, the server address <code>192.168.10.11</code> was assigned. An agent name, <code>myLab</code>, was also provided to uniquely identify the endpoint within Wazuh.
              </p>
              <div class="project-details__img-cont">
                <img
                  src="./assets/Automated SOC with SOAR Implementation/5deploy-agent.png"
                  alt="Configure Agent Deployment Screenshot"
                  class="constrained-image"
                  id="image-6"
                  onclick="showOriginal(this)"
                />
              </div>
              <p class="project-details__desc-para">
                The Wazuh dashboard provided specific PowerShell commands to download and install the agent on the Windows 10 endpoint. This included the <code>Invoke-WebRequest</code> command to retrieve the installer and <code>msiexec.exe</code> for silent installation, ensuring the agent connects to the Wazuh Manager at <code>192.168.10.11</code> and is named <code>myLab</code>. Following this, <code>NET START WazuhSvc</code> started the agent service.
              </p>
              <div class="project-details__img-cont">
                <img
                  src="./assets/Automated SOC with SOAR Implementation/6-deploying-command.png"
                  alt="Deploying Command Screenshot"
                  class="constrained-image"
                  id="image-7"
                  onclick="showOriginal(this)"
                />
              </div>
              <p class="project-details__desc-para">
                After running the deployment commands on the Windows 10 endpoint, the Wazuh agent successfully registered. The dashboard now displays "myLab" (<code>192.168.10.10</code>) as an active agent, confirming it is sending security data for monitoring.
              </p>
              <div class="project-details__img-cont">
                <img
                  src="./assets/Automated SOC with SOAR Implementation/7-node.png"
                  alt="Wazuh Node Screenshot"
                  class="constrained-image"
                  id="image-8"
                  onclick="showOriginal(this)"
                />
              </div>
              <h3 class="project-details__content-title">Installing TheHive Dependencies (Java)</h3>
              <p class="project-details__desc-para">
                Installation of TheHive, the incident response platform, commenced by ensuring all necessary Java dependencies were in place. TheHive relies on Apache Cassandra for its distributed database. Elasticsearch is another dependency for TheHive, providing powerful search and analytics capabilities for incident data.
              </p>
              <div class="project-details__img-cont">
                <img
                  src="./assets/Automated SOC with SOAR Implementation/8-java.png"
                  alt="Java Installation Screenshot"
                  class="constrained-image"
                  id="image-9"
                  onclick="showOriginal(this)"
                />
              </div>
              <div class="project-details__img-cont">
                <img
                  src="./assets/Automated SOC with SOAR Implementation/9-cassandra-status.png"
                  alt="Cassandra Status Screenshot"
                  class="constrained-image"
                  id="image-10"
                  onclick="showOriginal(this)"
                />
              </div>
              <div class="project-details__img-cont">
                <img
                  src="./assets/Automated SOC with SOAR Implementation/10-elasticsearch-status.png"
                  alt="Elasticsearch Status Screenshot"
                  class="constrained-image"
                  id="image-11"
                  onclick="showOriginal(this)"
                />
              </div>
              <p class="project-details__desc-para">
                After installing TheHive, file permissions were correctly set to ensure proper operation and security. The <code>ls -la /opt/thp</code> output initially showed root as the owner. To align with TheHive's operational requirements, the file ownership for <code>/opt/thp</code> was changed recursively to <code>thehive:thehive</code> using the <code>chown -R thehive:thehive /opt/thp</code> command.
              </p>
              <div class="project-details__img-cont">
                <img
                  src="./assets/Automated SOC with SOAR Implementation/11-root-owner.png"
                  alt="Root Owner Screenshot"
                  class="constrained-image"
                  id="image-12"
                  onclick="showOriginal(this)"
                />
              </div>
              <div class="project-details__img-cont">
                <img
                  src="./assets/Automated SOC with SOAR Implementation/12-change-ownership.png"
                  alt="Change Ownership Screenshot 1"
                  class="constrained-image"
                  id="image-13"
                  onclick="showOriginal(this)"
                />
              </div>
              <div class="project-details__img-cont">
                <img
                  src="./assets/Automated SOC with SOAR Implementation/13-change-ownershipU.png"
                  alt="Change Ownership Screenshot 2"
                  class="constrained-image"
                  id="image-14"
                  onclick="showOriginal(this)"
                />
              </div>
              <p class="project-details__desc-para">
                With the installation, permission adjustments, and configurations complete, TheHive's web interface became accessible, confirming successful deployment and readiness for incident management operations.
              </p>
              <div class="project-details__img-cont">
                <img
                  src="./assets/Automated SOC with SOAR Implementation/14-thehive.png"
                  alt="TheHive Web Interface Screenshot"
                  class="constrained-image"
                  id="image-15"
                  onclick="showOriginal(this)"
                />
              </div>
              <p class="project-details__desc-para">
                Default credentials for TheHive are: <code>admin@thehive.local - secret</code>. An error occurred when attempting to log in with these credentials.
              </p>
              <div class="project-details__img-cont">
                <img
                  src="./assets/Automated SOC with SOAR Implementation/15-errorHive.png"
                  alt="TheHive Login Error Screenshot"
                  class="constrained-image"
                  id="image-16"
                  onclick="showOriginal(this)"
                />
              </div>
              <p class="project-details__desc-para">
                Upon checking the Elasticsearch service, it was found to have failed to start due to being killed by the Out Of Memory (OOM) Killer, indicating insufficient available memory to run the service.
              </p>
              <div class="project-details__img-cont">
                <img
                  src="./assets/Automated SOC with SOAR Implementation/16-esError.png"
                  alt="Elasticsearch Error Screenshot"
                  class="constrained-image"
                  id="image-17"
                  onclick="showOriginal(this)"
                />
              </div>
              <h4>Why does the OOM Killer activate?</h4>
              <p class="project-details__desc-para">
                The OOM Killer is a mechanism in the Linux kernel that activates when the system is critically low on memory. It selects and terminates processes to free up memory and prevent the entire system from crashing or becoming unresponsive. Elasticsearch, especially with default configurations or when handling significant data, can be memory-intensive.
              </p>
              <h4>How to solve this problem:</h4>
              <ol>
                <li><strong>Increase Available Memory:</strong> The most direct solution is to provide more RAM to the machine running Elasticsearch. If possible, upgrade the system's memory.</li>
                <li><strong>Reduce Elasticsearch Memory Usage:</strong> If increasing RAM is not possible, Elasticsearch needs to be configured to use less memory. This involves adjusting the JVM heap size that Elasticsearch uses.</li>
              </ol>
              <p class="project-details__desc-para">
                The chosen solution was to increase the RAM of the VM. With the increased RAM, the Elasticsearch service now runs without OOM issues, allowing TheHive to start and authenticate correctly.
              </p>
              <div class="project-details__img-cont">
                <img
                  src="./assets/Automated SOC with SOAR Implementation/17-theHiveLoggedin.png"
                  alt="TheHive Logged In Screenshot"
                  class="constrained-image"
                  id="image-18"
                  onclick="showOriginal(this)"
                />
              </div>
              <h3 class="project-details__content-title">Configuring Wazuh in Win10 Machine</h3>
              <p class="project-details__desc-para">
                To ingest Sysmon logs into Wazuh for comprehensive endpoint monitoring, the full name of the Sysmon operational log (<code>Microsoft-Windows-Sysmon/Operational</code>) was identified within the Event Viewer.
              </p>
              <div class="project-details__img-cont">
                <img
                  src="./assets/Automated SOC with SOAR Implementation/18-sysmonPath.png"
                  alt="Sysmon Path Screenshot"
                  class="constrained-image"
                  id="image-19"
                  onclick="showOriginal(this)"
                />
              </div>
              <p class="project-details__desc-para">
                To integrate Sysmon logs with Wazuh, the <code>ossec.conf</code> file on the Windows 10 agent was modified. A <code>&lt;localfile&gt;</code> entry was added, pointing to the <code>Microsoft-Windows-Sysmon/Operational</code> event channel, ensuring these security events are collected and forwarded to the Wazuh Manager for analysis.
              </p>
              <div class="project-details__img-cont">
                <img
                  src="./assets/Automated SOC with SOAR Implementation/19-ossecConf.png"
                  alt="ossec.conf Configuration Screenshot"
                  class="constrained-image"
                  id="image-20"
                  onclick="showOriginal(this)"
                />
              </div>
              <p class="project-details__desc-para">
                After modifying the <code>ossec.conf</code> file, the Wazuh agent service on the Windows 10 endpoint was restarted. This ensured configuration changes took effect immediately, allowing the agent to begin collecting Sysmon logs as configured.
              </p>
              <div class="project-details__img-cont">
                <img
                  src="./assets/Automated SOC with SOAR Implementation/20-restartWazuh.png"
                  alt="Restart Wazuh Screenshot"
                  class="constrained-image"
                  id="image-21"
                  onclick="showOriginal(this)"
                />
              </div>
              <p class="project-details__desc-para">
                With the Wazuh agent restarted and properly configured, Sysmon logs were verified to be successfully ingested and displayed within the Wazuh dashboard. The search filter for "sysmon" confirmed that relevant events from the Windows 10 endpoint were actively flowing into the system for monitoring and analysis.
              </p>
              <div class="project-details__img-cont">
                <img
                  src="./assets/Automated SOC with SOAR Implementation/21-sysmon-wazuh.png"
                  alt="Sysmon Wazuh Dashboard Screenshot"
                  class="constrained-image"
                  id="image-22"
                  onclick="showOriginal(this)"
                />
              </div>
              <p class="project-details__desc-para">
                To simulate a real-world threat and test monitoring capabilities, Mimikatz—a tool commonly used for credential access—was executed on the Windows 10 endpoint. This action generated specific security events that Wazuh was configured to detect and log.
              </p>
              <div class="project-details__img-cont">
                <img
                  src="./assets/Automated SOC with SOAR Implementation/22-run-mimikatz.png"
                  alt="Run Mimikatz Screenshot"
                  class="constrained-image"
                  id="image-23"
                  onclick="showOriginal(this)"
                />
              </div>
              <p class="project-details__desc-para">
                After executing Mimikatz, the Wazuh dashboard initially showed "No Results" for "mimikatz" alerts. This confirmed that while Sysmon logs were being collected, Wazuh's default ruleset did not yet contain specific detections for this type of threat, demonstrating the need for custom rule creation to enhance detection capabilities.
              </p>
              <div class="project-details__img-cont">
                <img
                  src="./assets/Automated SOC with SOAR Implementation/23-no-result.png"
                  alt="No Result Screenshot"
                  class="constrained-image"
                  id="image-24"
                  onclick="showOriginal(this)"
                />
              </div>
              <p class="project-details__desc-para">
                Before modifying Wazuh's core configuration, a backup of the existing <code>ossec.conf</code> file was created to ensure the ability to restore the original configuration if needed, minimizing disruption during rule development and testing.
              </p>
              <div class="project-details__img-cont">
                <img
                  src="./assets/Automated SOC with SOAR Implementation/24-copy-conf.png"
                  alt="Copy Conf Screenshot"
                  class="constrained-image"
                  id="image-25"
                  onclick="showOriginal(this)"
                />
              </div>
              <p class="project-details__desc-para">
                To ensure all raw logs, including those that do not immediately trigger an alert, are stored for later analysis, the <code>ossec.conf</code> file was modified. Specifically, the <code>logall</code> and <code>logall_json</code> parameters were changed from "no" to "yes" within the global configuration. This enabled full fidelity logging, essential for detailed investigations and custom rule development.
              </p>
              <div class="project-details__img-cont">
                <img
                  src="./assets/Automated SOC with SOAR Implementation/25-configured-file.png"
                  alt="Configured File Screenshot"
                  class="constrained-image"
                  id="image-26"
                  onclick="showOriginal(this)"
                />
              </div>
              <p class="project-details__desc-para">
                <code>systemctl restart wazuh-manager.service</code>
              </p>
              <p class="project-details__desc-para">
                To complement the full log collection enabled in Wazuh, the <code>filebeat.yml</code> configuration was modified. Specifically, <code>archives: enabled</code> was set to <code>true</code> under the <code>filebeat.modules.wazuh.alerts</code> section. This ensures that raw, non-alerting logs, critical for in-depth analysis and custom rule creation, are also ingested into Elasticsearch for comprehensive visibility.
              </p>
              <div class="project-details__img-cont">
                <img
                  src="./assets/Automated SOC with SOAR Implementation/26-filebeat-conf.png"
                  alt="Filebeat Configuration Screenshot"
                  class="constrained-image"
                  id="image-27"
                  onclick="showOriginal(this)"
                />
              </div>
              <p class="project-details__desc-para">
                <code>systemctl restart filebeat</code>
              </p>
              <p class="project-details__desc-para">
                To prepare for analyzing the newly enabled full logs, "Dashboards Management" -> "Index patterns" was navigated within the Wazuh interface to create a new index pattern. This step ensures that the raw log data, including archival logs, is properly indexed and searchable for analysis. However, an error occurred. Creating a new index pattern with a single <code>*</code> resolved the issue.
              </p>
              <div class="project-details__img-cont">
                <img
                  src="./assets/Automated SOC with SOAR Implementation/27-index1.png"
                  alt="Index Pattern 1 Screenshot"
                  class="constrained-image"
                  id="image-28"
                  onclick="showOriginal(this)"
                />
              </div>
              <div class="project-details__img-cont">
                <img
                  src="./assets/Automated SOC with SOAR Implementation/27-index2.png"
                  alt="Index Pattern 2 Screenshot"
                  class="constrained-image"
                  id="image-29"
                  onclick="showOriginal(this)"
                />
              </div>
              <div class="project-details__img-cont">
                <img
                  src="./assets/Automated SOC with SOAR Implementation/27-index3.png"
                  alt="Index Pattern 3 Screenshot"
                  class="constrained-image"
                  id="image-30"
                  onclick="showOriginal(this)"
                />
              </div>
              <div class="project-details__img-cont">
                <img
                  src="./assets/Automated SOC with SOAR Implementation/28-index4Error.png"
                  alt="Index Pattern Error Screenshot"
                  class="constrained-image"
                  id="image-31"
                  onclick="showOriginal(this)"
                />
              </div>
              <div class="project-details__img-cont">
                <img
                  src="./assets/Automated SOC with SOAR Implementation/29-indexPattern.png"
                  alt="Index Pattern Resolved Screenshot"
                  class="constrained-image"
                  id="image-32"
                  onclick="showOriginal(this)"
                />
              </div>
              <p class="project-details__desc-para">
                To confirm that Sysmon successfully captured the Mimikatz execution and Wazuh archived the raw event, <code>cat archives.json</code> was piped through <code>grep -i mimikatz</code>. The output clearly showed the detailed Sysmon event logs related to the Mimikatz process, confirming that the comprehensive logging setup effectively collects even non-alerting security events. This data is now available for further analysis and custom rule creation.
              </p>
              <div class="project-details__img-cont">
                <img
                  src="./assets/Automated SOC with SOAR Implementation/30-check-logs.png"
                  alt="Check Logs Screenshot"
                  class="constrained-image"
                  id="image-33"
                  onclick="showOriginal(this)"
                />
              </div>
              <p class="project-details__desc-para">
                After enabling full log collection and verifying the raw <code>archives.json</code> file, the Wazuh dashboard's "wazuh-archives-*" index was searched for "mimikatz" events. The successful query, showing "11 hits" and displaying the detailed Sysmon logs related to Mimikatz execution, confirmed that the raw, non-alerting events are now fully searchable and accessible within the Wazuh interface.
              </p>
              <div class="project-details__img-cont">
                <img
                  src="./assets/Automated SOC with SOAR Implementation/31-wazuh-dashboard-hit.png"
                  alt="Wazuh Dashboard Hits Screenshot"
                  class="constrained-image"
                  id="image-34"
                  onclick="showOriginal(this)"
                />
              </div>
              <p class="project-details__desc-para">
                To create a custom rule for Mimikatz detection, "Server Management" -> "Rules" -> "Manage Rule Files" was navigated in the Wazuh dashboard. <code>0800-sysmon_id_1.xml</code> was identified as the appropriate file within the <code>ruleset/rules</code> directory. This is where the specific detection logic for Mimikatz activity would be added.
              </p>
              <div class="project-details__img-cont">
                <img
                  src="./assets/Automated SOC with SOAR Implementation/32-rule-file.png"
                  alt="Rule File Screenshot"
                  class="constrained-image"
                  id="image-35"
                  onclick="showOriginal(this)"
                />
              </div>
              <p class="project-details__desc-para">
                Before defining the custom detection rule, the archived Mimikatz logs in the Wazuh dashboard were analyzed. Specifically, the <code>data.win.eventdata.originalFileName</code> field, which contains "mimikatz.exe," was extracted. This unique and reliable indicator would be used as a key element in the custom rule to accurately detect future Mimikatz executions.
              </p>
              <div class="project-details__img-cont">
                <img
                  src="./assets/Automated SOC with SOAR Implementation/33-original-file-name.png"
                  alt="Original File Name Screenshot"
                  class="constrained-image"
                  id="image-36"
                  onclick="showOriginal(this)"
                />
              </div>
              <p class="project-details__desc-para">
                With the relevant log data identified, a custom rule was crafted within <code>local_rules.xml</code> to detect Mimikatz execution. This rule is designed with the highest critical <code>level="15"</code> and specifically targets <code>originalFileName</code> for "mimikatz.exe" (case-insensitive). It was also linked to MITRE ATT&CK T1003 (OS Credential Dumping), providing immediate threat context.
              </p>
              <div class="project-details__img-cont">
                <img
                  src="./assets/Automated SOC with SOAR Implementation/34-rule.png"
                  alt="Custom Rule Screenshot"
                  class="constrained-image"
                  id="image-37"
                  onclick="showOriginal(this)"
                />
              </div>
              <p class="project-details__desc-para">
                After restarting the Wazuh manager and re-executing Mimikatz on the Windows 10 endpoint, the custom detection rule immediately triggered a high-severity alert. The Wazuh dashboard displayed a new event with <code>rule.mitre.id</code> as T1003 (Credential Access) and <code>rule.description</code> clearly stating "Mimikatz Usage Detected!!!".
              </p>
              <div class="project-details__img-cont">
                <img
                  src="./assets/Automated SOC with SOAR Implementation/35-rule-detected.png"
                  alt="Rule Detected Screenshot"
                  class="constrained-image"
                  id="image-38"
                  onclick="showOriginal(this)"
                />
              </div>
              <h3 class="project-details__content-title">Integrating SOAR</h3>
              <p class="project-details__desc-para">
                To enable automated incident response, Shuffle, the SOAR platform, was integrated with Wazuh. The initial configuration within Shuffle involved setting up a new "Wazuh-alerts" webhook. The critical step was obtaining the unique "Webhook URI" (<code>https://shuffler.io/api/v1/hooks/webhook</code>), which would act as the communication channel for Wazuh alerts to be sent to Shuffle for orchestration and automation. This setup laid the groundwork for Shuffle to receive and process security alerts.
              </p>
              <div class="project-details__img-cont">
                <img
                  src="./assets/Automated SOC with SOAR Implementation/36-webhook.png"
                  alt="Webhook Configuration Screenshot"
                  class="constrained-image"
                  id="image-39"
                  onclick="showOriginal(this)"
                />
              </div>
              <p class="project-details__desc-para">
                To bridge Wazuh and Shuffle, the <code>ossec.conf</code> file on the Wazuh Manager was modified, adding an <code>&lt;integration&gt;</code> block. This configuration directs Wazuh to forward alerts to Shuffle's webhook URI, specifically including the custom Mimikatz alert (<code>rule_id 100002</code>). By specifying <code>alert_format</code> as <code>json</code>, alerts are ensured to be sent in a structured format, enabling seamless parsing and automation within Shuffle.
              </p>
              <div class="project-details__img-cont">
                <img
                  src="./assets/Automated SOC with SOAR Implementation/37-ossec-conf.png"
                  alt="ossec.conf Integration Screenshot"
                  class="constrained-image"
                  id="image-40"
                  onclick="showOriginal(this)"
                />
              </div>
              <p class="project-details__desc-para">
                Following the <code>ossec.conf</code> modifications and restarting the Wazuh service, the Shuffle webhook was initiated. The screenshot confirmed its successful activation, displaying "Webhook: running" and a notification indicating "Successfully started webhook".
              </p>
              <div class="project-details__img-cont">
                <img
                  src="./assets/Automated SOC with SOAR Implementation/38-webhook-running.png"
                  alt="Webhook Running Screenshot"
                  class="constrained-image"
                  id="image-41"
                  onclick="showOriginal(this)"
                />
              </div>
              <p class="project-details__desc-para">
                Mimikatz was re-executed on the Windows 10 endpoint. The screenshot confirmed that the alert was successfully ingested by Shuffle, showing a "FINISHED" status for the webhook event. The JSON payload revealed the custom <code>rule_id: "100002"</code>, a "Mimikatz Usage Detected!!!" title, and associated details like <code>severity: 3</code>. This validated the seamless flow of high-fidelity alerts from Wazuh to Shuffle, confirming the SOAR platform was ready to automate responses based on critical security events.
              </p>
              <div class="project-details__img-cont">
                <img
                  src="./assets/Automated SOC with SOAR Implementation/39-shuffle-finished.png"
                  alt="Shuffle Finished Screenshot"
                  class="constrained-image"
                  id="image-42"
                  onclick="showOriginal(this)"
                />
              </div>
              <p class="project-details__desc-para">
                To enrich the alert data and facilitate threat intelligence lookups, the automated workflow needed specific details from the Mimikatz alert. The raw event data highlighted the <code>hashes</code> field which contained the SHA1 hash (D1F783...). Crucially, within the same log, the SHA256 hash was also present, which would be the primary identifier used for reputation checks. This extraction step is vital for context-rich incident analysis.
              </p>
              <div class="project-details__img-cont">
                <img
                  src="./assets/Automated SOC with SOAR Implementation/40-hashes.png"
                  alt="Hashes Screenshot"
                  class="constrained-image"
                  id="image-43"
                  onclick="showOriginal(this)"
                />
              </div>
              <p class="project-details__desc-para">
                To automate the VirusTotal lookup, a "Regex capture group" action was implemented within Shuffle. This step extracted the SHA256 hash from the incoming Wazuh alert. The Input data was set to <code>$exec.text.win.eventdata.hashes</code>, targeting the field containing the hash string. The Regex used, <code>SHA256=([0-9A-Fa-f]{64})</code>, precisely identified and captured the 64-character SHA256 value. This ensured that only the relevant hash was extracted, preparing it for the next step in the automated workflow.
              </p>
              <div class="project-details__img-cont">
                <img
                  src="./assets/Automated SOC with SOAR Implementation/41-regex-capture.png"
                  alt="Regex Capture Group Screenshot"
                  class="constrained-image"
                  id="image-44"
                  onclick="showOriginal(this)"
                />
              </div>
              <p class="project-details__desc-para">
                With the SHA256 hash successfully extracted, a lookup was performed on VirusTotal to gather reputation information about the Mimikatz executable. A "Get a hash report" action was set up within Shuffle. The extracted SHA256 hash was connected to the VirusTotal query. The Id field was populated with <code>$sha256_regex.group_0</code>, which pulled the hash directly from the previous parsing step. This ensured Shuffle automatically sent the correct hash to VirusTotal for reputation analysis, integrating external threat intelligence into the automated workflow.
              </p>
              <div class="project-details__img-cont">
                <img
                  src="./assets/Automated SOC with SOAR Implementation/42-virustotal.png"
                  alt="VirusTotal Lookup Screenshot"
                  class="constrained-image"
                  id="image-45"
                  onclick="showOriginal(this)"
                />
              </div>
              <h3 class="project-details__content-title">Troubleshooting: VirusTotal API Error</h3>
              <p class="project-details__desc-para">
                After configuring the VirusTotal lookup, the workflow encountered an error. The screenshot showed a <code>status: 404</code> and an error message "Resource not found". This indicated that the API endpoint or the way the hash was being sent to VirusTotal was incorrect, preventing a successful lookup.
              </p>
              <div class="project-details__img-cont">
                <img
                  src="./assets/Automated SOC with SOAR Implementation/43-404.png"
                  alt="VirusTotal API Error Screenshot"
                  class="constrained-image"
                  id="image-46"
                  onclick="showOriginal(this)"
                />
              </div>
              <p class="project-details__desc-para">
                To resolve the "Resource not found" error, the available VirusTotal API actions within Shuffle were reviewed. The correct endpoint for retrieving a hash report was identified as <code>GET /files/{id}</code>. The issue was resolved by correcting the regex to pick "list".
              </p>
              <div class="project-details__img-cont">
                <img
                  src="./assets/Automated SOC with SOAR Implementation/44-issue-resolved.png"
                  alt="Issue Resolved Screenshot"
                  class="constrained-image"
                  id="image-47"
                  onclick="showOriginal(this)"
                />
              </div>
              <p class="project-details__desc-para">
                After correcting the API endpoint, the VirusTotal lookup within Shuffle showed a successful result. The output clearly indicated <code>malicious: 64</code> under <code>last_analysis_stats</code>, confirming that 64 out of the analyzed security vendors identified the file as malicious. This successful integration provides immediate, actionable threat intelligence directly within the automated workflow, verifying the malicious nature of the Mimikatz executable.
              </p>
              <div class="project-details__img-cont">
                <img
                  src="./assets/Automated SOC with SOAR Implementation/45-virustotal-success.png"
                  alt="VirusTotal Success Screenshot"
                  class="constrained-image"
                  id="image-48"
                  onclick="showOriginal(this)"
                />
              </div>
              <h3 class="project-details__content-title">TheHive Integration</h3>
              <p class="project-details__desc-para">
                To begin integrating TheHive directly with Wazuh, the <code>/var/ossec/integrations</code> directory on the Wazuh Manager was navigated to. Listing the contents of this directory revealed existing integration scripts such as <code>shuffle.py</code>, <code>virustotal.py</code>, and <code>slack.py</code>. This step confirmed the location where custom integration scripts, like the one to be used for TheHive, are stored and executed by Wazuh.
              </p>
              <div class="project-details__img-cont">
                <img
                  src="./assets/Automated SOC with SOAR Implementation/46-integrations-folder.png"
                  alt="Integrations Folder Screenshot"
                  class="constrained-image"
                  id="image-49"
                  onclick="showOriginal(this)"
                />
              </div>
              <p class="project-details__desc-para">
                To facilitate direct integration between Wazuh and TheHive, a new custom script named <code>custom-w2thive</code> was created within the <code>/var/ossec/integrations</code> directory. This Python script would act as the bridge, processing Wazuh alerts and forwarding them to TheHive. This custom solution allows for tailored incident creation and management directly from Wazuh, bypassing the need for an intermediary SOAR platform like Shuffle for this specific integration.
              </p>
              <div class="project-details__img-cont">
                <img
                  src="./assets/Automated SOC with SOAR Implementation/47-script.png"
                  alt="Custom Script Screenshot"
                  class="constrained-image"
                  id="image-50"
                  onclick="showOriginal(this)"
                />
              </div>
              <p class="project-details__desc-para">
                The following commands were run to ensure correct permissions:
              </p>
              <ul>
                <li><code>sudo chmod 755 /var/ossec/integrations/custom-w2thive.py</code></li>
                <li><code>sudo chmod 755 /var/ossec/integrations/custom-w2thive</code></li>
                <li><code>sudo chown root:wazuh /var/ossec/integrations/custom-w2thive.py</code></li>
                <li><code>sudo chown root:wazuh /var/ossec/integrations/custom-w2thive</code></li>
              </ul>
              <p class="project-details__desc-para">
                To activate the direct integration, the <code>ossec.conf</code> file on the Wazuh Manager was modified, adding a new <code>&lt;integration&gt;</code> block for <code>custom-w2thive</code>. The configuration details included: the <code>hook_url</code> set to TheHive server's IP and port 9000, and a dedicated <code>api_key</code> for authentication. The <code>alert_format</code> was specified as <code>json</code> to ensure structured data transfer.
              </p>
              <div class="project-details__img-cont">
                <img
                  src="./assets/Automated SOC with SOAR Implementation/48-api.png"
                  alt="API Key Configuration Screenshot"
                  class="constrained-image"
                  id="image-51"
                  onclick="showOriginal(this)"
                />
              </div>
              <div class="project-details__img-cont">
                <img
                  src="./assets/Automated SOC with SOAR Implementation/49-api2.png"
                  alt="API Key Configuration Screenshot 2"
                  class="constrained-image"
                  id="image-52"
                  onclick="showOriginal(this)"
                />
              </div>
              <p class="project-details__desc-para">
                After restarting the Wazuh service, TheHive's alert dashboard was navigated to verify the integration. New alerts were successfully received from Wazuh.
              </p>
              <div class="project-details__img-cont">
                <img
                  src="./assets/Automated SOC with SOAR Implementation/50-thehive-alert.png"
                  alt="TheHive Alert Screenshot"
                  class="constrained-image"
                  id="image-53"
                  onclick="showOriginal(this)"
                />
              </div>
              <div class="project-details__img-cont">
                <img
                  src="./assets/Automated SOC with SOAR Implementation/51-thehive-alert2.png"
                  alt="TheHive Alert Screenshot 2"
                  class="constrained-image"
                  id="image-54"
                  onclick="showOriginal(this)"
                />
              </div>
              <p class="project-details__desc-para">
                After re-executing Mimikatz on the Windows 10 endpoint, TheHive's alert dashboard immediately displayed a new, critical alert. The alert was titled "Mimikatz Usage Detected!!!" and directly referenced the custom Wazuh rule (<code>rule.id: 100002</code>). This confirmed the seamless end-to-end integration: Wazuh detected the threat, and the custom integration script successfully forwarded the alert to TheHive for immediate case management. This automated alert creation significantly reduces response time and ensures critical incidents are promptly addressed.
              </p>
              <div class="project-details__img-cont">
                <img
                  src="./assets/Automated SOC with SOAR Implementation/52-mima.png"
                  alt="Mimikatz Alert Screenshot"
                  class="constrained-image"
                  id="image-55"
                  onclick="showOriginal(this)"
                />
              </div>
              <div class="project-details__img-cont">
                <img
                  src="./assets/Automated SOC with SOAR Implementation/53-mima1.png"
                  alt="Mimikatz Alert Screenshot 2"
                  class="constrained-image"
                  id="image-56"
                  onclick="showOriginal(this)"
                />
              </div>
              <div class="project-details__img-cont">
                <img
                  src="./assets/Automated SOC with SOAR Implementation/54-mima2.png"
                  alt="Mimikatz Alert Screenshot 3"
                  class="constrained-image"
                  id="image-57"
                  onclick="showOriginal(this)"
                />
              </div>
              <h3 class="project-details__content-title">Automated Notification: Sending Email to Analyst</h3>
              <p class="project-details__desc-para">
                To ensure the analyst is immediately notified of critical incidents, a "Send email shuffle" action was added to the workflow. The email configuration set the recipient to <code>test@outlook.com</code>, the subject line to "High Severity Alert!", and the body dynamically populated key alert details. This included the alert title (<code>$exec.title</code>), the original filename (<code>$exec.text.win.eventdata.originalFileName</code>), and the affected host (<code>$exec.text.win.system.computer</code>). This automated email ensures timely communication and prompts the analyst to begin their investigation in TheHive.
              </p>
              <div class="project-details__img-cont">
                <img
                  src="./assets/Automated SOC with SOAR Implementation/55-email.png"
                  alt="Email Configuration Screenshot"
                  class="constrained-image"
                  id="image-58"
                  onclick="showOriginal(this)"
                />
              </div>
              <p class="project-details__desc-para">
                After the full workflow execution, the successful delivery of the automated email notification to the analyst was observed. The email, sent by the "Shuffle Email App," had the subject "High Severity Alert!" and dynamically includes critical details: "Mimikatz Usage Detected!!! File name: mimikatz.exe activity on host DESKTOP-G6HR1ED". This final step in the SOAR playbook ensures that analysts are promptly informed of high-priority incidents, enabling them to initiate investigations swiftly.
              </p>
              <div class="project-details__img-cont">
                <img
                  src="./assets/Automated SOC with SOAR Implementation/56.email.png"
                  alt="Email Delivery Screenshot"
                  class="constrained-image"
                  id="image-59"
                  onclick="showOriginal(this)"
                />
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>
    <footer class="main-footer">
      <div class="main-container">
        <div class="main-footer__upper">
          <div class="main-footer__row main-footer__row-1">
            <h4 class="heading heading-sm text-lt">John Doe</h4>
            <p class="main-footer__short-desc">
              Lorem ipsum dolor sit amet consectetur adipisicing elit facilis tempora explicabo quae quod deserunt
            </p>
          </div>
        </div>
        <div class="main-footer__lower">
          <p class="text-primary" style="font-size: 1.6rem;">
            &copy; Copyright 2021. Made by
            <a rel="noreferrer" target="_blank" href="https://rammaheshwari.com">Ram Maheshwari</a>
          </p>
        </div>
      </div>
    </footer>
    <div id="image-modal" class="modal">
      <span class="close" onclick="closeModal()">&times;</span>
      <img id="modal-img" class="modal-content" />
    </div>
    <script>
      const images = document.querySelectorAll('.constrained-image');
      const modal = document.getElementById("image-modal");
      const modalImg = document.getElementById("modal-img");

      modal.style.display = "none";

      images.forEach(img => {
        img.onload = () => {
          if (img.naturalWidth > 1890 || img.naturalHeight > 1100) {
            img.classList.add('larger');
          }
        };
        img.onclick = () => showOriginal(img.id);
      });

      function showOriginal(imgId) {
        const img = document.getElementById(imgId);
        modalImg.src = img.src;
        modal.style.display = "flex";
      }

      function closeModal() {
        modal.style.display = "none";
      }
    </script>
    <script src="./index.js"></script>
  </body>
</html>
